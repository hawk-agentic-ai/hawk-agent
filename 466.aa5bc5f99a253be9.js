"use strict";(self.webpackChunkhedge_accounting_sfx=self.webpackChunkhedge_accounting_sfx||[]).push([[466],{7466:(O,C,s)=>{s.r(C),s.d(C,{PromptHistoryComponent:()=>E});var h=s(467),_=s(177),y=s(9641),l=s(4341),u=s(1141),v=s(2242),d=s(8833),p=s(1570),m=s(8542),t=s(4438),P=s(6806),M=s(7488),f=s(5779);const b=()=>({width:"100vw",height:"90vh","border-top-left-radius":"16px","border-top-right-radius":"16px","max-width":"100vw","max-height":"90vh"});function k(g,x){if(1&g&&(t.j41(0,"option",24),t.EFF(1),t.k0s()),2&g){const e=x.$implicit;t.Y8G("value",e.value),t.R7$(),t.JRh(e.label)}}function w(g,x){if(1&g&&(t.j41(0,"form",25)(1,"div",26)(2,"div",27)(3,"div",28)(4,"div",29),t.EFF(5,"Quick Details"),t.k0s()(),t.j41(6,"div",30)(7,"div",31)(8,"div")(9,"label",32),t.EFF(10,"Status"),t.k0s(),t.j41(11,"div",33),t.EFF(12),t.nI1(13,"titlecase"),t.k0s()(),t.j41(14,"div")(15,"label",32),t.EFF(16,"Created"),t.k0s(),t.j41(17,"div",34),t.EFF(18),t.k0s()()()()()(),t.j41(19,"div",26)(20,"div",27)(21,"div",28)(22,"div",29),t.EFF(23,"Prompt"),t.k0s()(),t.j41(24,"div",30)(25,"div",35),t.EFF(26),t.k0s()()()(),t.j41(27,"div",36)(28,"div",37)(29,"div",38)(30,"div",29),t.EFF(31,"Response"),t.k0s()(),t.j41(32,"div",39),t.nrm(33,"div",40),t.k0s()()(),t.j41(34,"div",26)(35,"div",27)(36,"div",28)(37,"div",29),t.EFF(38,"Token Usage"),t.k0s()(),t.j41(39,"div",30)(40,"div",41)(41,"div",42)(42,"div",43),t.EFF(43,"Input"),t.k0s(),t.j41(44,"div",44),t.EFF(45),t.k0s()(),t.j41(46,"div",45)(47,"div",43),t.EFF(48,"Output"),t.k0s(),t.j41(49,"div",44),t.EFF(50),t.k0s()(),t.j41(51,"div",46)(52,"div",43),t.EFF(53,"Total"),t.k0s(),t.j41(54,"div",44),t.EFF(55),t.k0s()()()()()()()),2&g){const e=t.XpG();t.R7$(11),t.HbH(e.getStatusClass(e.selectedPrompt.agent_status)),t.R7$(),t.SpI(" ",t.bMT(13,9,e.selectedPrompt.agent_status)," "),t.R7$(6),t.JRh(e.formatShortDate(e.selectedPrompt.created_at)),t.R7$(8),t.JRh(e.selectedPrompt.prompt_text),t.R7$(7),t.Y8G("innerHTML",e.formatResponseText(e.selectedPrompt.response_text),t.npT),t.R7$(12),t.JRh(e.selectedPrompt.input_tokens),t.R7$(5),t.JRh(e.selectedPrompt.output_tokens),t.R7$(5),t.JRh(e.selectedPrompt.total_tokens)}}function D(g,x){if(1&g){const e=t.RV6();t.j41(0,"div",47)(1,"button",48),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.showDialog=!1)}),t.EFF(2,"Close"),t.k0s(),t.j41(3,"button",49),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.downloadPrompt(n.selectedPrompt))}),t.nrm(4,"i",50),t.EFF(5," Download "),t.k0s()()}}let E=(()=>{class g{constructor(e,r){this.hawkAgentService=e,this.route=r,this.promptHistory=[],this.totalCount=0,this.isLoading=!1,this.searchTerm="",this.selectedStatus=null,this.selectedDateRange="all",this.showDialog=!1,this.dialogMode="view",this.selectedPrompt=null,this.isDialogLoading=!1,this.columnDefs=[{field:"created_at",headerName:"Date",minWidth:150,width:150,sortable:!0,sort:"desc",cellClass:"flex items-center text-sm text-gray-700",valueFormatter:n=>this.formatShortDate(n.value)},{field:"msg_uid",headerName:"Message UID",minWidth:140,width:140,sortable:!0,cellClass:"flex items-center text-sm text-gray-700",cellRenderer:n=>`<span class="font-mono text-sm">${n.value||""}</span>`},{field:"instruction_id",headerName:"Instruction ID",minWidth:130,width:130,sortable:!0,cellClass:"flex items-center text-sm text-gray-700",cellRenderer:n=>`<span class="font-mono text-sm">${n.value||""}</span>`},{field:"prompt_text",headerName:"Prompt",flex:2,minWidth:300,sortable:!0,cellClass:"flex items-center text-sm text-gray-700",cellRenderer:n=>{const a=n.value||"No prompt available",o=a.length>120?a.substring(0,120)+"...":a;return`<div class="text-sm" title="${a}" style="word-wrap: break-word;">${o}</div>`}},{field:"agent_status",headerName:"Status",minWidth:110,width:110,sortable:!0,cellClass:"flex items-center justify-center text-sm text-gray-700",cellRenderer:n=>{const a=n.value||"";let o="";switch(a){case"completed":o="bg-green-100 text-green-800";break;case"failed":o="bg-red-100 text-red-800";break;case"pending":o="bg-yellow-100 text-yellow-800";break;case"cancelled":o="bg-gray-100 text-gray-800";break;default:o="bg-blue-100 text-blue-800"}const i=document.createElement("span");return i.className=`inline-flex items-center px-2.5 py-0.5 rounded-full text-sm font-medium ${o}`,i.textContent=a.charAt(0).toUpperCase()+a.slice(1),i}},{field:"total_tokens",headerName:"Tokens",minWidth:90,width:90,sortable:!0,cellClass:"flex items-center justify-center text-sm text-gray-700"},{headerName:"Actions",minWidth:120,width:120,sortable:!1,pinned:"right",cellClass:"flex items-center justify-center text-sm text-gray-700",cellRenderer:n=>{const a=document.createElement("div");a.className="flex items-center justify-center space-x-2";const o=document.createElement("button");o.className="text-gray-500 hover:text-blue-600 p-1 transition-colors duration-200",o.title="View Prompt Details",o.innerHTML='<i class="pi pi-eye text-sm"></i>',o.addEventListener("click",()=>n.context.componentParent.viewPrompt(n.data));const i=document.createElement("button");return i.className="text-gray-500 hover:text-green-600 p-1 transition-colors duration-200",i.title="Download Prompt",i.innerHTML='<i class="pi pi-download text-sm"></i>',i.addEventListener("click",()=>n.context.componentParent.downloadPrompt(n.data)),a.appendChild(o),a.appendChild(i),a}}],this.defaultColDef={resizable:!0,sortable:!0,filter:"agSetColumnFilter",minWidth:100,suppressSizeToFit:!1},this.gridOptions={animateRows:!1,rowHeight:48,headerHeight:40,suppressRowClickSelection:!0,suppressCellFocus:!0,suppressHorizontalScroll:!1,pagination:!0,paginationPageSize:50,paginationPageSizeSelector:[25,50,100],skipHeaderOnAutoSize:!0,context:{componentParent:this}},this.statusOptions=[{label:"Completed",value:"completed"},{label:"Failed",value:"failed"},{label:"Pending",value:"pending"},{label:"Cancelled",value:"cancelled"}]}ngOnInit(){this.route.queryParams.subscribe(e=>{const r=e.msg_uid,n=e.instruction_id;(r||n)&&(this._pendingOpen={msg_uid:r,instruction_id:n}),this.loadPromptHistory()}),this.setupRealtimeUpdates()}onWindowResize(){this.gridApi&&setTimeout(()=>{this.gridApi?.sizeColumnsToFit()},100)}ngOnDestroy(){this.sessionsSubscription&&this.sessionsSubscription.unsubscribe(),this.searchTimer&&clearTimeout(this.searchTimer)}setupRealtimeUpdates(){console.log("Real-time updates placeholder")}onGridReady(e){this.gridApi=e.api,setTimeout(()=>{this.gridApi&&(this.gridApi.sizeColumnsToFit(),this.gridApi.refreshCells())},100)}onCellClicked(e){}onSearchChange(e){this.searchTimer&&clearTimeout(this.searchTimer),this.searchTimer=setTimeout(()=>{this.loadPromptHistory()},500)}loadPromptHistory(){var e=this;return(0,h.A)(function*(){e.isLoading=!0;try{let n=yield e.hawkAgentService.getSessions();if(e.selectedStatus&&(n=n.filter(i=>i.agent_status===e.selectedStatus)),e.searchTerm&&e.searchTerm.trim()){const i=e.searchTerm.toLowerCase();n=n.filter(c=>c.msg_uid?.toLowerCase().includes(i)||c.instruction_id?.toLowerCase().includes(i)||c.metadata?.prompt_text?.toLowerCase().includes(i))}if("all"!==e.selectedDateRange){const i=new Date,c=new Date;switch(e.selectedDateRange){case"today":c.setHours(0,0,0,0);break;case"7days":c.setDate(i.getDate()-7);break;case"30days":c.setDate(i.getDate()-30);break;case"90days":c.setDate(i.getDate()-90)}n=n.filter(R=>new Date(R.created_at)>=c)}const a=n.slice(0,1e3);e.promptHistory=a.map(i=>e.mapSessionToHistoryRow(i)),e.totalCount=n.length,e.gridApi&&(e.gridApi.setGridOption("rowData",e.promptHistory),setTimeout(()=>{e.gridApi?.sizeColumnsToFit()},50));const o=e._pendingOpen;if(o&&e.promptHistory?.length){let i=e.promptHistory.find(c=>o.msg_uid&&c.msg_uid===o.msg_uid||o.instruction_id&&c.instruction_id===o.instruction_id);i&&(e.viewPrompt(i),e._pendingOpen=void 0)}}catch(r){console.error("Error loading prompt history:",r),e.generateMockData()}finally{e.isLoading=!1}})()}mapSessionToHistoryRow(e){const n=e.agent_response?.usage?{input:e.agent_response.usage.input_tokens||e.agent_response.usage.prompt_tokens||0,output:e.agent_response.usage.output_tokens||e.agent_response.usage.completion_tokens||0,total:e.agent_response.usage.total_tokens||0}:e.agent_response?.input_tokens||e.agent_response?.output_tokens?{input:e.agent_response.input_tokens||0,output:e.agent_response.output_tokens||0,total:e.agent_response.total_tokens||0}:e.metadata?.usage?{input:e.metadata.usage.input_tokens||e.metadata.usage.prompt_tokens||0,output:e.metadata.usage.output_tokens||e.metadata.usage.completion_tokens||0,total:e.metadata.usage.total_tokens||0}:e.metadata?.input_tokens||e.metadata?.output_tokens?{input:e.metadata.input_tokens||0,output:e.metadata.output_tokens||0,total:e.metadata.total_tokens||0}:{input:0,output:0,total:0};return 0===n.total&&(n.input>0||n.output>0)&&(n.total=n.input+n.output),{id:e.id||0,msg_uid:e.msg_uid||"",instruction_id:e.instruction_id||"",prompt_text:e.metadata?.prompt_text||"No prompt text available",response_text:e.agent_response?.text||"No response available",agent_status:e.agent_status,input_tokens:n.input,output_tokens:n.output,total_tokens:n.total,amount:e.metadata?.amount,currency:e.metadata?.currency,transaction_date:e.metadata?.transaction_date,template_category:e.template_category||"template",template_index:e.template_index||1,created_at:"string"==typeof e.created_at?new Date(e.created_at):e.created_at||new Date,agent_end_time:e.updated_at||e.created_at,execution_time_ms:0,user_id:e.user_id||"",metadata:e.metadata,agent_response:e.agent_response}}generateMockData(){this.promptHistory=[],this.totalCount=0}viewPrompt(e){!e||this.isDialogLoading||(this.selectedPrompt=e,this.dialogMode="view",this.showDialog=!0,this.isDialogLoading=!1)}sharePrompt(e){console.log("Share prompt:",e)}downloadPrompt(e){if(!e)return;const n=new Blob([JSON.stringify({message_uid:e.msg_uid,instruction_id:e.instruction_id,prompt:e.prompt_text,response:e.response_text,agent_status:e.agent_status,tokens:{input:e.input_tokens,output:e.output_tokens,total:e.total_tokens},created_at:e.created_at,agent_end_time:e.agent_end_time},null,2)],{type:"application/json"}),a=URL.createObjectURL(n),o=document.createElement("a");o.href=a,o.download=`prompt-${e.msg_uid}.json`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(a)}exportData(){console.log("Export data functionality to be implemented")}formatShortDate(e){return e?("string"==typeof e?new Date(e):e).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):""}formatDate(e){return e?("string"==typeof e?new Date(e):e).toLocaleString():""}formatResponseText(e){return e?e.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/```([\s\S]*?)```/g,'<code class="block bg-gray-100 p-2 rounded text-xs">$1</code>').replace(/`([^`]+)`/g,'<code class="bg-gray-100 px-1 rounded text-xs">$1</code>').replace(/^(\d+)\.\s+(.+)$/gm,'<div class="ml-4">$1. $2</div>').replace(/^[-*]\s+(.+)$/gm,'<div class="ml-4">\u2022 $1</div>').replace(/^##\s+(.+)$/gm,'<h3 class="text-base font-semibold mt-4 mb-2 text-gray-900">$1</h3>').replace(/^#\s+(.+)$/gm,'<h2 class="text-lg font-bold mt-4 mb-2 text-gray-900">$1</h2>').replace(/\n\n/g,"<br><br>").replace(/\n/g,"<br>"):""}getStatusClass(e){switch(e){case"completed":return"bg-green-100 text-green-800";case"failed":return"bg-red-100 text-red-800";case"pending":return"bg-yellow-100 text-yellow-800";case"cancelled":return"bg-gray-100 text-gray-800";default:return"bg-blue-100 text-blue-800"}}static{this.\u0275fac=function(r){return new(r||g)(t.rXU(P.G),t.rXU(M.nX))}}static{this.\u0275cmp=t.VBU({type:g,selectors:[["app-prompt-history"]],hostBindings:function(r,n){1&r&&t.bIt("resize",function(o){return n.onWindowResize(o)},!1,t.tSv)},standalone:!0,features:[t.aNF],decls:41,vars:15,consts:[[1,"p-6","flex","flex-col",2,"height","100vh","box-sizing","border-box"],[1,"mb-6","flex-shrink-0"],[1,"text-xl","font-semibold","text-gray-900","mb-2"],[1,"text-gray-600"],[1,"flex","items-center","gap-4","mb-4","flex-shrink-0"],[1,"flex-1","flex","items-center","gap-2"],[1,"filter-label"],["type","text","placeholder","Search prompts, UIDs...",1,"filter-input","flex-1","max-w-xs",3,"ngModelChange","ngModel"],[1,"flex","items-center","gap-2"],[1,"filter-input","w-40",3,"ngModelChange","change","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],["value","all"],["value","today"],["value","7days"],["value","30days"],["value","90days"],[1,"btn","btn-secondary","ml-auto",3,"click"],[1,"pi","pi-download"],[1,"bg-white","rounded-lg","shadow-sm","border","border-gray-200","flex-1","min-h-0",2,"overflow","hidden"],[1,"ag-theme-alpine",2,"width","100%","height","100%",3,"gridReady","columnDefs","rowData","defaultColDef","gridOptions"],["header","View Prompt Details","styleClass","entity-dialog entity-dialog-full",3,"visibleChange","visible","modal","closable"],["class","space-y-6 p-2 h-full flex flex-col",4,"ngIf"],["pTemplate","footer"],[3,"value"],[1,"space-y-6","p-2","h-full","flex","flex-col"],[1,"rounded-lg","border","border-gray-200","p-4","bg-white","flex-shrink-0"],[1,"grid","grid-cols-12","gap-4"],[1,"col-span-12","md:col-span-3","flex","items-center"],[1,"text-sm","font-semibold","text-gray-700"],[1,"col-span-12","md:col-span-9"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],[1,"block","text-sm","font-medium","text-gray-700","mb-1"],[1,"inline-flex","items-center","px-2","py-1","rounded","text-xs","font-medium"],[1,"text-sm"],[1,"bg-gray-50","border","rounded","p-3","text-sm","max-h-32","overflow-y-auto"],[1,"rounded-lg","border","border-gray-200","p-4","bg-white","flex-1","flex","flex-col"],[1,"grid","grid-cols-12","gap-4","h-full"],[1,"col-span-12","md:col-span-3","flex","items-start"],[1,"col-span-12","md:col-span-9","flex","flex-col","h-full"],[1,"bg-gray-50","border","rounded","p-3","text-sm","flex-1","overflow-y-auto","response-text",3,"innerHTML"],[1,"grid","grid-cols-3","gap-2","text-center"],[1,"bg-blue-50","rounded","p-2"],[1,"text-xs","text-gray-500"],[1,"font-semibold"],[1,"bg-green-50","rounded","p-2"],[1,"bg-purple-50","rounded","p-2"],[1,"flex","justify-end","space-x-3","pt-4","border-t","border-gray-200"],[1,"btn","btn-secondary",3,"click"],[1,"btn","btn-primary",3,"click"],[1,"pi","pi-download","mr-2"]],template:function(r,n){1&r&&(t.j41(0,"div",0)(1,"div",1)(2,"h2",2),t.EFF(3,"Prompt History"),t.k0s(),t.j41(4,"p",3),t.EFF(5,"View and manage HAWK Agent prompt history and responses"),t.k0s()(),t.j41(6,"div",4)(7,"div",5)(8,"label",6),t.EFF(9,"Search:"),t.k0s(),t.j41(10,"input",7),t.mxI("ngModelChange",function(o){return t.DH7(n.searchTerm,o)||(n.searchTerm=o),o}),t.bIt("ngModelChange",function(o){return n.onSearchChange(o)}),t.k0s()(),t.j41(11,"div",8)(12,"label",6),t.EFF(13,"Status:"),t.k0s(),t.j41(14,"select",9),t.mxI("ngModelChange",function(o){return t.DH7(n.selectedStatus,o)||(n.selectedStatus=o),o}),t.bIt("change",function(){return n.loadPromptHistory()}),t.j41(15,"option",10),t.EFF(16,"All Status"),t.k0s(),t.DNE(17,k,2,2,"option",11),t.k0s()(),t.j41(18,"div",8)(19,"label",6),t.EFF(20,"Date Range:"),t.k0s(),t.j41(21,"select",9),t.mxI("ngModelChange",function(o){return t.DH7(n.selectedDateRange,o)||(n.selectedDateRange=o),o}),t.bIt("change",function(){return n.loadPromptHistory()}),t.j41(22,"option",12),t.EFF(23,"All Time"),t.k0s(),t.j41(24,"option",13),t.EFF(25,"Today"),t.k0s(),t.j41(26,"option",14),t.EFF(27,"Last 7 Days"),t.k0s(),t.j41(28,"option",15),t.EFF(29,"Last 30 Days"),t.k0s(),t.j41(30,"option",16),t.EFF(31,"Last 90 Days"),t.k0s()()(),t.j41(32,"button",17),t.bIt("click",function(){return n.exportData()}),t.nrm(33,"i",18),t.j41(34,"span"),t.EFF(35,"Export"),t.k0s()()(),t.j41(36,"div",19)(37,"ag-grid-angular",20),t.bIt("gridReady",function(o){return n.onGridReady(o)}),t.k0s()(),t.j41(38,"p-dialog",21),t.mxI("visibleChange",function(o){return t.DH7(n.showDialog,o)||(n.showDialog=o),o}),t.DNE(39,w,56,11,"form",22)(40,D,6,0,"ng-template",23),t.k0s()()),2&r&&(t.R7$(10),t.R50("ngModel",n.searchTerm),t.R7$(4),t.R50("ngModel",n.selectedStatus),t.R7$(3),t.Y8G("ngForOf",n.statusOptions),t.R7$(4),t.R50("ngModel",n.selectedDateRange),t.R7$(16),t.Y8G("columnDefs",n.columnDefs)("rowData",n.promptHistory)("defaultColDef",n.defaultColDef)("gridOptions",n.gridOptions),t.R7$(),t.Aen(t.lJ4(14,b)),t.R50("visible",n.showDialog),t.Y8G("modal",!0)("closable",!0),t.R7$(),t.Y8G("ngIf",n.selectedPrompt))},dependencies:[_.MD,_.Sq,_.bT,_.PV,y.xs,l.YN,l.qT,l.xH,l.y7,l.me,l.wz,l.BC,l.cb,l.vS,l.cV,u.tm,f.Ei,v.u,d.kr,p.P,p.l,m.S],styles:["[_nghost-%COMP%]{display:block;height:100%;width:100%}.grid-container[_ngcontent-%COMP%]{position:relative;width:100%;height:100%}[_ngcontent-%COMP%]:is()   .ag-theme-alpine[_ngcontent-%COMP%]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,sans-serif;font-size:14px;line-height:1.5;width:100%!important;height:100%!important;position:relative}[_ngcontent-%COMP%]:is()   [_ngcontent-%COMP%]:is(.ag-root-wrapper, .ag-root)[_ngcontent-%COMP%]{width:100%!important;height:100%!important}[_ngcontent-%COMP%]:is()   .ag-theme-alpine[_ngcontent-%COMP%]   .ag-row[_ngcontent-%COMP%]{border-bottom:1px solid #f3f4f6}[_ngcontent-%COMP%]:is()   .ag-theme-alpine[_ngcontent-%COMP%]   .ag-cell[_ngcontent-%COMP%]{display:flex;align-items:center;padding:12px 8px;font-family:inherit;font-size:14px;line-height:1.5;color:#374151}[_ngcontent-%COMP%]:is()   .ag-theme-alpine[_ngcontent-%COMP%]   .ag-header-cell[_ngcontent-%COMP%]{font-family:inherit;font-size:14px;font-weight:600;color:#1f2937;background-color:#f9fafb;border-bottom:2px solid #e5e7eb}[_ngcontent-%COMP%]:is()   .ag-theme-alpine[_ngcontent-%COMP%]   .ag-header-cell-text[_ngcontent-%COMP%]{font-family:inherit;font-weight:600}[_ngcontent-%COMP%]:is()   .ag-cell[_ngcontent-%COMP%]   .inline-flex[_ngcontent-%COMP%]{font-family:inherit;font-size:14px}[_ngcontent-%COMP%]:is()   .ag-cell[_ngcontent-%COMP%]   .font-mono[_ngcontent-%COMP%]{font-family:SF Mono,Monaco,Cascadia Code,Roboto Mono,Consolas,Courier New,monospace;font-size:13px}[_ngcontent-%COMP%]:is()   .ag-cell[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-family:inherit}[_ngcontent-%COMP%]:is()   .ag-cell[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:14px}[_ngcontent-%COMP%]:is()   .ag-theme-alpine[_ngcontent-%COMP%]   .ag-row[_ngcontent-%COMP%]:hover{background-color:#f9fafb}[_ngcontent-%COMP%]:is()   .prompt-dialog[_ngcontent-%COMP%]   .p-dialog-header[_ngcontent-%COMP%]{border-bottom-width:1px}[_ngcontent-%COMP%]:is()   .prompt-dialog[_ngcontent-%COMP%]   .p-dialog-header[_ngcontent-%COMP%]{--tw-border-opacity: 1;border-color:rgb(229 231 235 / var(--tw-border-opacity, 1))}[_ngcontent-%COMP%]:is()   .prompt-dialog[_ngcontent-%COMP%]   .p-dialog-header[_ngcontent-%COMP%]{--tw-bg-opacity: 1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1))}[_ngcontent-%COMP%]:is()   .prompt-dialog[_ngcontent-%COMP%]   .p-dialog-header[_ngcontent-%COMP%]{padding-left:1rem;padding-right:1rem}[_ngcontent-%COMP%]:is()   .prompt-dialog[_ngcontent-%COMP%]   .p-dialog-header[_ngcontent-%COMP%]{padding-top:.75rem;padding-bottom:.75rem}[_ngcontent-%COMP%]:is()   .prompt-dialog[_ngcontent-%COMP%]   .p-dialog-title[_ngcontent-%COMP%]{font-size:1rem;line-height:1.5rem}[_ngcontent-%COMP%]:is()   .prompt-dialog[_ngcontent-%COMP%]   .p-dialog-title[_ngcontent-%COMP%]{font-weight:600}[_ngcontent-%COMP%]:is()   .prompt-dialog[_ngcontent-%COMP%]   .p-dialog-title[_ngcontent-%COMP%]{--tw-text-opacity: 1;color:rgb(17 24 39 / var(--tw-text-opacity, 1))}[_ngcontent-%COMP%]:is()   .prompt-dialog[_ngcontent-%COMP%]   .p-dialog-content[_ngcontent-%COMP%]{--tw-bg-opacity: 1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1))}[_ngcontent-%COMP%]:is()   .prompt-dialog[_ngcontent-%COMP%]   .p-dialog-content[_ngcontent-%COMP%]{padding:0}[_ngcontent-%COMP%]:is()   .prompt-dialog[_ngcontent-%COMP%]   .p-dialog-content[_ngcontent-%COMP%]{max-height:calc(90vh - 120px);overflow-y:auto}[_ngcontent-%COMP%]:is()   .prompt-dialog[_ngcontent-%COMP%]   .p-dialog-footer[_ngcontent-%COMP%]{border-top-width:1px}[_ngcontent-%COMP%]:is()   .prompt-dialog[_ngcontent-%COMP%]   .p-dialog-footer[_ngcontent-%COMP%]{--tw-border-opacity: 1;border-color:rgb(229 231 235 / var(--tw-border-opacity, 1))}[_ngcontent-%COMP%]:is()   .prompt-dialog[_ngcontent-%COMP%]   .p-dialog-footer[_ngcontent-%COMP%]{--tw-bg-opacity: 1;background-color:rgb(249 250 251 / var(--tw-bg-opacity, 1))}[_ngcontent-%COMP%]:is()   .prompt-dialog[_ngcontent-%COMP%]   .p-dialog-footer[_ngcontent-%COMP%]{padding-left:1rem;padding-right:1rem}[_ngcontent-%COMP%]:is()   .prompt-dialog[_ngcontent-%COMP%]   .p-dialog-footer[_ngcontent-%COMP%]{padding-top:.75rem;padding-bottom:.75rem}[_ngcontent-%COMP%]:is()   .entity-dialog-full[_ngcontent-%COMP%]   .p-dialog[_ngcontent-%COMP%]{position:fixed;bottom:0;left:0;right:0;margin:0!important;transform:none!important;border-radius:16px 16px 0 0!important}[_ngcontent-%COMP%]:is()   .response-text[_ngcontent-%COMP%]{font-family:ui-monospace,SFMono-Regular,SF Mono,Consolas,Liberation Mono,Menlo,monospace;line-height:1.6;white-space:pre-wrap;word-wrap:break-word}[_ngcontent-%COMP%]:is()   .response-text[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-weight:600;color:#1f2937}[_ngcontent-%COMP%]:is()   .response-text[_ngcontent-%COMP%]   em[_ngcontent-%COMP%]{font-style:italic;color:#374151}[_ngcontent-%COMP%]:is()   .response-text[_ngcontent-%COMP%]   code[_ngcontent-%COMP%]{font-family:inherit;font-size:.875em}[_ngcontent-%COMP%]:is()   .response-text[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:is(h2, h3)[_ngcontent-%COMP%]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif}"]})}}return g})()},6806:(O,C,s)=>{s.d(C,{G:()=>l});var h=s(467),_=s(7129),y=s(4438);let l=(()=>{class u{createSession(d,p,m,t,P){return(0,h.A)(function*(){const M={msg_uid:p,instruction_id:m,user_id:"test-user",session_type:"template",agent_status:"pending",agent_start_time:(new Date).toISOString(),template_category:t||"template",template_index:P||1,metadata:{prompt_text:d}};try{const f=(0,_.b)(),{error:b}=yield f.from("hawk_agent_sessions").upsert([M],{onConflict:"msg_uid"});if(b)throw b}catch(f){console.warn("createSession: proceeding without DB insert due to error:",f)}return{msg_uid:p,instruction_id:m,user_id:"test-user",session_type:"template",agent_status:"pending",template_category:t||"template",template_index:P||1,metadata:{prompt_text:d},created_at:(new Date).toISOString()}})()}getSessions(){return(0,h.A)(function*(){try{const d=(0,_.b)(),{data:p,error:m}=yield d.from("hawk_agent_sessions").select("*").order("created_at",{ascending:!1});if(m)throw m;return p||[]}catch(d){throw console.error("Error fetching sessions:",d),d}})()}updateSession(d,p){return(0,h.A)(function*(){try{const m=(0,_.b)(),{error:t}=yield m.from("hawk_agent_sessions").update(p).eq("msg_uid",d);if(t)throw t}catch(m){console.warn("updateSession: non-fatal error:",m)}})()}static{this.\u0275fac=function(p){return new(p||u)}}static{this.\u0275prov=y.jDH({token:u,factory:u.\u0275fac,providedIn:"root"})}}return u})()}}]);
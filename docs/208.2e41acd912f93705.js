"use strict";(self.webpackChunkhedge_accounting_sfx=self.webpackChunkhedge_accounting_sfx||[]).push([[208],{5208:(Te,v,u)=>{u.r(v),u.d(v,{PromptTemplatesComponent:()=>xe});var y=u(467),b=u(177),f=u(4341),x=u(1626),T=u(4211),C=u(1570),e=u(4438),I=u(345),P=u(8662),k=u(6806),R=u(4885);const F=["agentFrame"],w=["resultsSection"],j=()=>[1,2,3,4,5];function S(r,l){if(1&r){const t=e.RV6();e.j41(0,"div",21)(1,"div",22)(2,"div",23)(3,"span",24),e.EFF(4,"Prompt ready:"),e.k0s(),e.j41(5,"span",25),e.EFF(6),e.k0s()(),e.j41(7,"button",26),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.copyPrompt())}),e.nrm(8,"i",27),e.j41(9,"span"),e.EFF(10),e.k0s()(),e.j41(11,"button",28),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.sendPromptToIframe())}),e.nrm(12,"i",29),e.j41(13,"span"),e.EFF(14,"Send"),e.k0s()(),e.j41(15,"button",30),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.minimizePromptToast())}),e.nrm(16,"i",31),e.k0s(),e.j41(17,"button",32),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.dismissPromptToast())}),e.nrm(18,"i",33),e.k0s()()()}if(2&r){const t=e.XpG(2);e.R7$(6),e.JRh(t.incomingPrompt),e.R7$(4),e.JRh(t.copied?"Copied":"Copy")}}function E(r,l){if(1&r){const t=e.RV6();e.j41(0,"div",34)(1,"div",35),e.nrm(2,"i",36),e.j41(3,"span",37),e.EFF(4,"Prompt ready"),e.k0s(),e.j41(5,"button",38),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.copyPrompt())}),e.nrm(6,"i",39),e.k0s(),e.j41(7,"button",40),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.expandPromptToast())}),e.nrm(8,"i",41),e.k0s(),e.j41(9,"button",32),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.dismissPromptToast())}),e.nrm(10,"i",33),e.k0s()()()}}function $(r,l){if(1&r&&(e.j41(0,"div",15)(1,"div",16),e.DNE(2,S,19,2,"div",17)(3,E,11,0,"div",18),e.j41(4,"div",19),e.nrm(5,"iframe",20,0),e.k0s()()()),2&r){const t=e.XpG();e.R7$(2),e.Y8G("ngIf",t.incomingPrompt&&t.showPromptToast&&!t.isMinimized),e.R7$(),e.Y8G("ngIf",t.incomingPrompt&&t.showPromptToast&&t.isMinimized),e.R7$(2),e.Y8G("src",t.agentUrlSafe,e.f$h)}}function M(r,l){if(1&r){const t=e.RV6();e.j41(0,"button",67),e.bIt("click",function(){const i=e.eBV(t).$implicit,s=e.XpG(2);return e.Njj(s.onInstructionTypeSelect(i.key))}),e.EFF(1),e.j41(2,"span",68),e.EFF(3),e.k0s()()}if(2&r){const t=l.$implicit,n=e.XpG(2);e.Y8G("ngClass",n.activeInstructionType===t.key?"bg-blue-600 text-white shadow-md":"bg-gray-100 text-gray-700 hover:bg-gray-200"),e.R7$(),e.SpI(" ",t.label," "),e.R7$(2),e.SpI("(",t.count,")")}}function G(r,l){if(1&r){const t=e.RV6();e.j41(0,"button",73),e.bIt("click",function(){const i=e.eBV(t).$implicit,s=e.XpG(3);return e.Njj(s.loadRecentTemplate(i))}),e.EFF(1),e.k0s()}if(2&r){const t=l.$implicit;e.R7$(),e.SpI(" ",t.label," ")}}function D(r,l){if(1&r&&(e.j41(0,"div",69)(1,"h4",70),e.EFF(2,"Recent"),e.k0s(),e.j41(3,"div",71),e.DNE(4,G,2,1,"button",72),e.k0s()()),2&r){const t=e.XpG(2);e.R7$(4),e.Y8G("ngForOf",t.recentTemplates.slice(0,3))}}function V(r,l){if(1&r){const t=e.RV6();e.j41(0,"button",74),e.bIt("click",function(){const i=e.eBV(t).$implicit,s=e.XpG(2);return e.Njj(s.onCategorySelect(i.key))}),e.j41(1,"div",3)(2,"span",75),e.EFF(3),e.k0s(),e.j41(4,"span",76),e.EFF(5),e.k0s()()()}if(2&r){const t=l.$implicit,n=e.XpG(2);e.HbH(n.getCategoryTabClass(t.key)),e.R7$(3),e.JRh(t.label),e.R7$(),e.HbH(n.activeCategory===t.key?"bg-white bg-opacity-20 text-white":"bg-gray-200 text-gray-700"),e.R7$(),e.SpI(" ",t.count," ")}}function B(r,l){1&r&&(e.j41(0,"div",77)(1,"div",78),e.EFF(2,"\u{1f4c2}"),e.k0s(),e.j41(3,"div",79),e.EFF(4,"No categories available"),e.k0s(),e.j41(5,"div",80),e.EFF(6,"Select a different family type above"),e.k0s()())}function N(r,l){if(1&r&&(e.j41(0,"div",93),e.nrm(1,"i",94),e.EFF(2),e.k0s()),2&r){const t=e.XpG().$implicit;e.R7$(2),e.SpI("Dynamic Template (",(null==t.inputFields?null:t.inputFields.length)||0," input fields) ")}}function X(r,l){if(1&r){const t=e.RV6();e.j41(0,"label",81)(1,"div",82)(2,"input",83),e.bIt("change",function(){const i=e.eBV(t).index,s=e.XpG(2);return e.Njj(s.selectPrompt(i))}),e.k0s()(),e.j41(3,"div",84)(4,"div",85)(5,"div",86),e.EFF(6),e.k0s()(),e.j41(7,"div",87)(8,"div",88),e.EFF(9),e.k0s(),e.DNE(10,N,3,1,"div",89),e.k0s(),e.j41(11,"div",90)(12,"div",91),e.EFF(13),e.k0s(),e.j41(14,"div",92),e.EFF(15),e.k0s()()()()}if(2&r){const t=l.$implicit,n=l.index,i=e.XpG(2);e.R7$(2),e.Y8G("checked",i.selectedPromptIndex===n),e.R7$(4),e.SpI("Template ",n+1,""),e.R7$(3),e.JRh(t.template),e.R7$(),e.Y8G("ngIf",t.isDynamic),e.R7$(2),e.Y8G("title",t.usageCount+" uses"),e.R7$(),e.SpI(" ",i.formatUsageCount(t.usageCount)," "),e.R7$(),e.Y8G("title",t.successRate+"% success rate"),e.R7$(),e.SpI(" ",t.successRate,"% ")}}function A(r,l){1&r&&(e.j41(0,"div",95),e.EFF(1," No templates found for this type. "),e.k0s())}function O(r,l){if(1&r&&(e.j41(0,"span",110),e.EFF(1),e.k0s()),2&r){const t=e.XpG().$implicit;e.R7$(),e.JRh(t.text)}}function Y(r,l){if(1&r){const t=e.RV6();e.j41(0,"input",114),e.mxI("ngModelChange",function(i){e.eBV(t);const s=e.XpG(6);return e.DH7(s.amount,i)||(s.amount=i),e.Njj(i)}),e.k0s()}if(2&r){const t=e.XpG(6);e.R50("ngModel",t.amount)}}function U(r,l){if(1&r){const t=e.RV6();e.j41(0,"input",115),e.mxI("ngModelChange",function(i){e.eBV(t);const s=e.XpG(6);return e.DH7(s.date,i)||(s.date=i),e.Njj(i)}),e.k0s()}if(2&r){const t=e.XpG(6);e.R50("ngModel",t.date)}}function L(r,l){if(1&r&&(e.j41(0,"option",118),e.EFF(1),e.k0s()),2&r){const t=l.$implicit;e.Y8G("value",t),e.R7$(),e.JRh(t)}}function H(r,l){if(1&r){const t=e.RV6();e.j41(0,"select",116),e.bIt("ngModelChange",function(i){e.eBV(t);const s=e.XpG(2).$implicit,a=e.XpG(4);return e.Njj(a.onPlaceholderChange(s.name,i))}),e.DNE(1,L,2,2,"option",117),e.k0s()}if(2&r){const t=e.XpG(2).$implicit,n=e.XpG(4);e.Y8G("ngModel",n.placeholderValues[t.name]),e.R7$(),e.Y8G("ngForOf",n.getOptionsFor(t.name))("ngForTrackBy",n.trackByIndex)}}function K(r,l){if(1&r&&(e.qex(0),e.DNE(1,Y,1,1,"input",111)(2,U,1,1,"input",112)(3,H,2,3,"select",113),e.bVm()),2&r){const t=e.XpG().$implicit;e.R7$(),e.Y8G("ngIf","amount"===t.name),e.R7$(),e.Y8G("ngIf","date"===t.name),e.R7$(),e.Y8G("ngIf","amount"!==t.name&&"date"!==t.name)}}function J(r,l){if(1&r&&(e.qex(0),e.DNE(1,O,2,1,"span",108)(2,K,4,3,"ng-container",109),e.bVm()),2&r){const t=l.$implicit;e.R7$(),e.Y8G("ngIf","text"===t.type),e.R7$(),e.Y8G("ngIf","placeholder"===t.type)}}function z(r,l){if(1&r&&(e.j41(0,"div",106),e.DNE(1,J,3,2,"ng-container",107),e.k0s()),2&r){const t=e.XpG(3);e.R7$(),e.Y8G("ngForOf",t.previewParts)("ngForTrackBy",t.trackByPart)}}function W(r,l){if(1&r&&(e.j41(0,"span",110),e.EFF(1),e.k0s()),2&r){const t=e.XpG().$implicit;e.R7$(),e.JRh(t.text)}}function Q(r,l){if(1&r){const t=e.RV6();e.j41(0,"input",114),e.bIt("ngModelChange",function(i){e.eBV(t);const s=e.XpG(2).$implicit,a=e.XpG(4);return a.dynamicInputValues[s.name]=i,e.Njj(a.onDynamicInputChange())}),e.k0s()}if(2&r){const t=e.XpG(2).$implicit,n=e.XpG(4);e.Y8G("ngModel",n.dynamicInputValues[t.name])}}function q(r,l){if(1&r){const t=e.RV6();e.j41(0,"input",115),e.bIt("ngModelChange",function(i){e.eBV(t);const s=e.XpG(2).$implicit,a=e.XpG(4);return a.dynamicInputValues[s.name]=i,e.Njj(a.onDynamicInputChange())}),e.k0s()}if(2&r){const t=e.XpG(2).$implicit,n=e.XpG(4);e.Y8G("ngModel",n.dynamicInputValues[t.name])}}function Z(r,l){if(1&r){const t=e.RV6();e.j41(0,"input",122),e.bIt("ngModelChange",function(i){e.eBV(t);const s=e.XpG(2).$implicit,a=e.XpG(4);return a.dynamicInputValues[s.name]=i,e.Njj(a.onDynamicInputChange())}),e.k0s()}if(2&r){const t=e.XpG(2).$implicit,n=e.XpG(4);e.Y8G("placeholder",n.formatFieldLabel(t.name))("ngModel",n.dynamicInputValues[t.name])}}function ee(r,l){if(1&r&&(e.qex(0),e.DNE(1,Q,1,1,"input",111)(2,q,1,1,"input",112)(3,Z,1,2,"input",121),e.bVm()),2&r){const t=e.XpG().$implicit;e.R7$(),e.Y8G("ngIf","amount"===t.name),e.R7$(),e.Y8G("ngIf","date"===t.name),e.R7$(),e.Y8G("ngIf","amount"!==t.name&&"date"!==t.name)}}function te(r,l){if(1&r&&(e.qex(0),e.DNE(1,W,2,1,"span",108)(2,ee,4,3,"ng-container",109),e.bVm()),2&r){const t=l.$implicit;e.R7$(),e.Y8G("ngIf","text"===t.type),e.R7$(),e.Y8G("ngIf","placeholder"===t.type)}}function ne(r,l){if(1&r&&(e.j41(0,"div",123)(1,"div",124),e.EFF(2,"Filled Template Preview:"),e.k0s(),e.j41(3,"div",125),e.EFF(4),e.k0s()()),2&r){const t=e.XpG(4);e.R7$(4),e.JRh(t.getFilledTemplate())}}function ie(r,l){if(1&r&&(e.j41(0,"div",119)(1,"div",106),e.DNE(2,te,3,2,"ng-container",107),e.k0s(),e.DNE(3,ne,5,1,"div",120),e.k0s()),2&r){const t=e.XpG(3);e.R7$(2),e.Y8G("ngForOf",t.previewParts)("ngForTrackBy",t.trackByPart),e.R7$(),e.Y8G("ngIf",t.getSelectedTemplateInputFields().length>0)}}function re(r,l){1&r&&(e.j41(0,"span",126),e.nrm(1,"div",127),e.EFF(2," Processing... "),e.k0s())}function se(r,l){1&r&&(e.j41(0,"span",126),e.nrm(1,"i",29),e.EFF(2," Submit "),e.k0s())}function oe(r,l){if(1&r){const t=e.RV6();e.j41(0,"div",96)(1,"div",97)(2,"h4",98),e.EFF(3,"Configure Parameters"),e.k0s(),e.j41(4,"div",99)(5,"div",70),e.EFF(6,"Live Preview"),e.k0s(),e.DNE(7,z,2,2,"div",100)(8,ie,4,3,"div",101),e.k0s(),e.j41(9,"div",3)(10,"button",102),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.saveAsTemplate())}),e.nrm(11,"i",103),e.EFF(12," Save Template "),e.k0s(),e.j41(13,"button",104),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.usePrompt())}),e.DNE(14,re,3,0,"span",105)(15,se,3,0,"span",105),e.k0s()()()()}if(2&r){const t=e.XpG(2);e.R7$(7),e.Y8G("ngIf",!t.isSelectedTemplateDynamic()),e.R7$(),e.Y8G("ngIf",t.isSelectedTemplateDynamic()),e.R7$(5),e.Y8G("disabled",t.isLoading||!t.isFormValid()),e.R7$(),e.Y8G("ngIf",t.isLoading),e.R7$(),e.Y8G("ngIf",!t.isLoading)}}function ae(r,l){if(1&r&&(e.j41(0,"div",138)(1,"div",139),e.nrm(2,"i",140),e.j41(3,"span",141),e.EFF(4),e.k0s()(),e.j41(5,"div",139),e.nrm(6,"i",142),e.j41(7,"span",141),e.EFF(8),e.k0s()()()),2&r){const t=e.XpG().$implicit;e.R7$(4),e.JRh(t.msgUid),e.R7$(4),e.JRh(t.instructionId||"N/A")}}function le(r,l){if(1&r){const t=e.RV6();e.j41(0,"div",133),e.bIt("click",function(){const i=e.eBV(t).$implicit,s=e.XpG(3);return e.Njj(s.loadHistoryItem(i))}),e.j41(1,"div",134)(2,"div",75)(3,"div",86),e.EFF(4),e.k0s(),e.j41(5,"div",135),e.EFF(6),e.k0s(),e.DNE(7,ae,9,2,"div",136),e.k0s(),e.j41(8,"div",126)(9,"span",137),e.EFF(10),e.k0s()()()()}if(2&r){const t=l.$implicit,n=e.XpG(3);e.R7$(4),e.JRh(t.query),e.R7$(2),e.JRh(n.formatDate(t.timestamp)),e.R7$(),e.Y8G("ngIf",t.msgUid),e.R7$(2),e.Y8G("ngClass",n.getHistoryStatusClass(t.status)),e.R7$(),e.SpI(" ",t.status," ")}}function ce(r,l){if(1&r){const t=e.RV6();e.j41(0,"div",128)(1,"div",129)(2,"h3",49),e.EFF(3,"Query History"),e.k0s(),e.j41(4,"button",130),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.toggleHistory())}),e.nrm(5,"i",33),e.k0s()(),e.j41(6,"div",131),e.DNE(7,le,11,5,"div",132),e.k0s()()}if(2&r){const t=e.XpG(2);e.R7$(7),e.Y8G("ngForOf",t.queryHistory)}}function pe(r,l){1&r&&(e.j41(0,"div",148),e.nrm(1,"div",149),e.j41(2,"p",150),e.EFF(3,"Processing your request..."),e.k0s(),e.j41(4,"div",151),e.nrm(5,"div",152),e.k0s()())}function de(r,l){1&r&&(e.j41(0,"div",195),e.nrm(1,"div",196),e.j41(2,"span",197),e.EFF(3,"Receiving response..."),e.k0s(),e.j41(4,"div",198),e.nrm(5,"div",199)(6,"div",200)(7,"div",201),e.k0s()())}function me(r,l){if(1&r&&(e.j41(0,"div",202)(1,"div",203),e.EFF(2),e.k0s()()),2&r){const t=e.XpG(4);e.R7$(2),e.JRh(t.getResponseMetadata())}}function ue(r,l){if(1&r){const t=e.RV6();e.j41(0,"button",204),e.bIt("click",function(){const i=e.eBV(t).$implicit,s=e.XpG(4);return e.Njj(s.setRating(i))}),e.nrm(1,"i",205),e.k0s()}if(2&r){const t=l.$implicit,n=e.XpG(4);e.HbH(t<=n.currentRating?"text-yellow-400 hover:text-yellow-500":"text-gray-300 hover:text-yellow-300")}}function ge(r,l){1&r&&(e.j41(0,"span"),e.EFF(1,"Thank you! This positive feedback helps improve template accuracy."),e.k0s())}function _e(r,l){1&r&&(e.j41(0,"span"),e.EFF(1,"Thank you for the feedback. We'll work to improve this template."),e.k0s())}function he(r,l){1&r&&(e.j41(0,"span"),e.EFF(1,"Thanks for reporting this issue. We'll review and improve this template."),e.k0s())}function fe(r,l){if(1&r&&(e.j41(0,"div",206)(1,"div",207),e.nrm(2,"i",208),e.j41(3,"span",209),e.DNE(4,ge,2,0,"span",109)(5,_e,2,0,"span",109)(6,he,2,0,"span",109),e.k0s()()()),2&r){const t=e.XpG(4);e.R7$(4),e.Y8G("ngIf",t.currentRating>=4),e.R7$(),e.Y8G("ngIf",3===t.currentRating),e.R7$(),e.Y8G("ngIf",t.currentRating<=2)}}function ye(r,l){if(1&r){const t=e.RV6();e.j41(0,"div",153)(1,"div",6)(2,"div",154),e.nrm(3,"i"),e.EFF(4),e.k0s(),e.j41(5,"span",5),e.EFF(6),e.k0s()(),e.j41(7,"div",155)(8,"div",156),e.EFF(9,"Request Identifiers"),e.k0s(),e.j41(10,"div",157)(11,"div",126),e.nrm(12,"i",158),e.j41(13,"div")(14,"div",5),e.EFF(15,"Message UID"),e.k0s(),e.j41(16,"div",159),e.EFF(17),e.k0s()()(),e.j41(18,"div",126),e.nrm(19,"i",160),e.j41(20,"div")(21,"div",5),e.EFF(22,"Instruction ID"),e.k0s(),e.j41(23,"div",159),e.EFF(24),e.k0s()()()()(),e.j41(25,"div",161)(26,"div",162)(27,"div",163),e.EFF(28,"Amount"),e.k0s(),e.j41(29,"div",164),e.EFF(30),e.k0s()(),e.j41(31,"div",165)(32,"div",166),e.EFF(33,"Date"),e.k0s(),e.j41(34,"div",167),e.EFF(35),e.k0s()(),e.j41(36,"div",168)(37,"div",169),e.EFF(38,"Type"),e.k0s(),e.j41(39,"div",170),e.EFF(40),e.k0s()()(),e.j41(41,"div",171)(42,"div",145)(43,"div",172),e.nrm(44,"div",173),e.DNE(45,de,8,0,"div",174),e.k0s()(),e.DNE(46,me,3,1,"div",175),e.k0s(),e.j41(47,"div",176)(48,"button",102),e.bIt("click",function(){e.eBV(t);const i=e.XpG(3);return e.Njj(i.exportReport())}),e.nrm(49,"i",177),e.EFF(50," Export Report "),e.k0s(),e.j41(51,"button",102),e.bIt("click",function(){e.eBV(t);const i=e.XpG(3);return e.Njj(i.createTicket())}),e.nrm(52,"i",178),e.EFF(53," Create Ticket "),e.k0s(),e.j41(54,"button",102),e.bIt("click",function(){e.eBV(t);const i=e.XpG(3);return e.Njj(i.scheduleReview())}),e.nrm(55,"i",179),e.EFF(56," Schedule Review "),e.k0s(),e.j41(57,"button",102),e.bIt("click",function(){e.eBV(t);const i=e.XpG(3);return e.Njj(i.shareResults())}),e.nrm(58,"i",180),e.EFF(59," Share "),e.k0s()(),e.j41(60,"div",181)(61,"div",3)(62,"div",75)(63,"h4",182),e.EFF(64,"Rate this response"),e.k0s(),e.j41(65,"p",183),e.EFF(66,"Help improve template accuracy by rating the quality of this result"),e.k0s(),e.j41(67,"div",126)(68,"div",139),e.DNE(69,ue,2,2,"button",184),e.k0s(),e.j41(70,"div",185)(71,"button",186),e.bIt("click",function(){e.eBV(t);const i=e.XpG(3);return e.Njj(i.setRating(5))}),e.nrm(72,"i",187),e.EFF(73," Correct "),e.k0s(),e.j41(74,"button",186),e.bIt("click",function(){e.eBV(t);const i=e.XpG(3);return e.Njj(i.setRating(1))}),e.nrm(75,"i",188),e.EFF(76," Incorrect "),e.k0s()(),e.j41(77,"div",189)(78,"button",186),e.bIt("click",function(){e.eBV(t);const i=e.XpG(3);return e.Njj(i.setCompletionStatus("complete"))}),e.nrm(79,"i",190),e.EFF(80," Complete "),e.k0s(),e.j41(81,"button",186),e.bIt("click",function(){e.eBV(t);const i=e.XpG(3);return e.Njj(i.setCompletionStatus("incomplete"))}),e.nrm(82,"i",191),e.EFF(83," Incomplete "),e.k0s()()(),e.DNE(84,fe,7,3,"div",192),e.k0s(),e.j41(85,"div",193)(86,"div",5),e.EFF(87,"Template Success Rate"),e.k0s(),e.j41(88,"div",194),e.EFF(89),e.k0s(),e.j41(90,"div",5),e.EFF(91),e.k0s()()()()()}if(2&r){const t=e.XpG(3);e.R7$(2),e.Y8G("ngClass",t.getStatusBadgeClass()),e.R7$(),e.HbH(t.getStatusIcon()),e.R7$(),e.SpI(" ",t.getResultStatus()," "),e.R7$(2),e.JRh(t.getCurrentDateTime()),e.R7$(11),e.JRh(t.currentMsgUid),e.R7$(7),e.JRh(t.currentInstructionId),e.R7$(6),e.Lme("",(null==t.amount?null:t.amount.toLocaleString())||"N/A"," ",t.currency,""),e.R7$(5),e.JRh(t.date||"N/A"),e.R7$(5),e.JRh(t.getCategoryLabel(t.activeCategory)),e.R7$(4),e.Y8G("innerHTML",t.getFormattedResponse(),e.npT),e.R7$(),e.Y8G("ngIf",t.isStreaming),e.R7$(),e.Y8G("ngIf",t.getResponseMetadata()),e.R7$(23),e.Y8G("ngForOf",e.lJ4(29,j))("ngForTrackBy",t.trackByIndex),e.R7$(2),e.HbH(t.currentRating>=4?"bg-green-100 text-green-700 border-green-300":"bg-gray-100 text-gray-600 border-gray-300 hover:bg-green-50"),e.R7$(3),e.HbH(t.currentRating<=2?"bg-red-100 text-red-700 border-red-300":"bg-gray-100 text-gray-600 border-gray-300 hover:bg-red-50"),e.R7$(4),e.HbH("complete"===t.completionStatus?"bg-blue-100 text-blue-700 border-blue-300":"bg-gray-100 text-gray-600 border-gray-300 hover:bg-blue-50"),e.R7$(3),e.HbH("incomplete"===t.completionStatus?"bg-orange-100 text-orange-700 border-orange-300":"bg-gray-100 text-gray-600 border-gray-300 hover:bg-orange-50"),e.R7$(3),e.Y8G("ngIf",t.currentRating>0),e.R7$(4),e.HbH(t.getSuccessRateClass(t.getCurrentTemplateSuccessRate())),e.R7$(),e.SpI(" ",t.getCurrentTemplateSuccessRate(),"% "),e.R7$(2),e.SpI("",t.getCurrentTemplateUsageCount()," total uses")}}function be(r,l){if(1&r){const t=e.RV6();e.j41(0,"div",143,1)(2,"div",131)(3,"div",144)(4,"div")(5,"h3",49),e.EFF(6,"Results"),e.k0s(),e.j41(7,"p",50),e.EFF(8),e.k0s()(),e.j41(9,"div",126)(10,"button",130),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.clearResults())}),e.nrm(11,"i",33),e.EFF(12," Clear Results "),e.k0s()()(),e.j41(13,"div",145),e.DNE(14,pe,6,0,"div",146)(15,ye,92,30,"div",147),e.k0s()()()}if(2&r){const t=e.XpG(2);e.R7$(8),e.JRh(t.lastQuery),e.R7$(6),e.Y8G("ngIf",t.isLoading),e.R7$(),e.Y8G("ngIf",!t.isLoading&&t.apiResponse)}}function ve(r,l){if(1&r&&(e.j41(0,"div",42)(1,"div",43)(2,"div",44),e.DNE(3,M,4,3,"button",45),e.k0s()(),e.j41(4,"div",46)(5,"div",47)(6,"div",48)(7,"h3",49),e.EFF(8,"Categories"),e.k0s(),e.j41(9,"p",50),e.EFF(10),e.k0s()(),e.DNE(11,D,5,1,"div",51),e.j41(12,"div",52)(13,"div",53),e.DNE(14,V,6,6,"button",54)(15,B,7,0,"div",55),e.k0s()()(),e.j41(16,"div",56)(17,"div",57)(18,"div",3)(19,"div")(20,"h3",49),e.EFF(21),e.k0s(),e.j41(22,"p",50),e.EFF(23),e.k0s()(),e.j41(24,"div",58),e.EFF(25," Template Mode "),e.k0s()()(),e.j41(26,"div",59)(27,"div",60)(28,"h3",49),e.EFF(29,"Select Template"),e.k0s()(),e.j41(30,"div",52)(31,"div",61),e.DNE(32,X,16,8,"label",62)(33,A,2,0,"div",63),e.k0s()(),e.DNE(34,oe,16,5,"div",64),e.k0s()(),e.DNE(35,ce,8,1,"div",65),e.k0s(),e.DNE(36,be,16,3,"div",66),e.k0s()),2&r){const t=e.XpG();e.R7$(3),e.Y8G("ngForOf",t.instructionTypes)("ngForTrackBy",t.trackByKey),e.R7$(7),e.JRh(t.getSelectedInstructionTypeLabel()),e.R7$(),e.Y8G("ngIf",t.recentTemplates.length>0),e.R7$(3),e.Y8G("ngForOf",t.getCurrentCategories())("ngForTrackBy",t.trackByKey),e.R7$(),e.Y8G("ngIf",0===t.getCurrentCategories().length),e.R7$(6),e.JRh(t.getSelectedCategoryLabel()),e.R7$(2),e.Lme("",t.currentPrompts.length," template",1!==t.currentPrompts.length?"s":""," available"),e.R7$(9),e.Y8G("ngForOf",t.currentPrompts)("ngForTrackBy",t.trackByIndex),e.R7$(),e.Y8G("ngIf",!t.currentPrompts||0===t.currentPrompts.length),e.R7$(),e.Y8G("ngIf",t.selectedPromptIndex>=0),e.R7$(),e.Y8G("ngIf",t.showHistory),e.R7$(),e.Y8G("ngIf",t.showResults)}}let xe=(()=>{class r{constructor(t,n,i,s,a,o){this.sanitizer=t,this.http=n,this.currencyService=i,this.hawkAgentService=s,this.promptTemplatesService=a,this.cdr=o,this.isAgentMode=!1,this.showResults=!1,this.isLoading=!1,this.isStreaming=!1,this.apiResponse="",this.lastQuery="",this.currentMsgUid="",this.currentInstructionId="",this.completionStatus=null,this.msgUidCounter=21,this.instructionIdCounter=21,this.streamBuffer="",this.recentTemplates=[],this.queryHistory=[],this.showHistory=!1,this.currentRating=0,this.hasRated=!1,this.iframeLoaded=!1,this.agentUrl=T.Xh,this.agentOrigin=T.wK,this.loadNotice=!1,this.incomingPrompt=null,this.copied=!1,this.showPromptToast=!1,this.isMinimized=!1,this.onMessage=c=>{},this.previewParts=[],this.currentPrompts=[],this.dynamicInputValues={},this.instructionTypes=[],this.activeInstructionType="",this.categories=[],this.activeCategory="",this.allConvertedTemplates=[],this.promptsMap={},this.selectedPromptIndex=-1,this.currencies=[],this.currency="SGD",this.amount=null,this.date=(new Date).toISOString().split("T")[0],this.scopes=["Branch","Subsidiary","Associate","TMU"],this.subsidiaryLevels=["Entity","Subsidiary","Branch"],this.riskFactors=["FX Rate","Interest Rate","Commodity","Equity"],this.genericOptions=["Option A","Option B","Option C"],this.placeholderValues={},this.trackByIndex=(c,p)=>c,this.trackByKey=(c,p)=>p.key,this.trackByPart=(c,p)=>p.type+":"+(p.text??p.name??c)}generateMsgUID(){const n=`MSG_UID_${this.msgUidCounter.toString().padStart(4,"0")}`;return this.msgUidCounter++,n}generateInstructionId(){const n=`INST${this.instructionIdCounter.toString().padStart(4,"0")}`;return this.instructionIdCounter++,n}initializeCounters(){const t=localStorage.getItem("msgUidCounter"),n=localStorage.getItem("instructionIdCounter");this.msgUidCounter=t?parseInt(t):21,this.instructionIdCounter=n?parseInt(n):21}saveCounters(){localStorage.setItem("msgUidCounter",this.msgUidCounter.toString()),localStorage.setItem("instructionIdCounter",this.instructionIdCounter.toString())}resetIdCounters(t=21,n=21){this.msgUidCounter=t,this.instructionIdCounter=n,this.saveCounters(),console.log(`ID counters reset: MSG_UID starts at ${t}, INST starts at ${n}`)}ngOnInit(){this.initializeCounters(),this.loadCurrencies(),this.loadTemplatesFromDatabase(),this.refreshPromptsForCategory(),this.initPlaceholdersForSelectedPrompt(),this.buildPreviewParts(),this.agentUrlSafe=this.sanitizer.bypassSecurityTrustResourceUrl(this.agentUrl),window.addEventListener("message",this.onMessage);const t=history?.state||{};t&&"string"==typeof t.presetPrompt&&t.presetPrompt.trim()&&(this.incomingPrompt=t.presetPrompt.trim(),this.showPromptToast=!0,this.isAgentMode=!0)}ngOnDestroy(){if(window.removeEventListener("message",this.onMessage),this.noticeTimer&&clearTimeout(this.noticeTimer),this.reader&&!this.reader.closed){try{this.reader.cancel()}catch(t){console.warn("Reader cleanup error:",t)}this.reader=void 0}this.isStreaming=!1}loadCurrencies(){this.currencyService.getCurrencyCodes().subscribe({next:t=>{this.currencies=t,t.includes("SGD")?this.currency="SGD":t.length>0&&(this.currency=t[0])},error:t=>{console.error("Error loading currencies:",t),this.currencies=["USD","EUR","GBP","JPY","SGD","AUD"]}})}loadTemplatesFromDatabase(){var t=this;return(0,y.A)(function*(){try{t.promptTemplatesService.templates$.subscribe(n=>{Array.isArray(n)&&t.updateTemplatesFromDatabase(n)}),yield t.promptTemplatesService.loadTemplates()}catch(n){console.error("Failed to load templates from database:",n)}})()}updateTemplatesFromDatabase(t){this.allConvertedTemplates=[],this.categories=[],this.instructionTypes=[];const n=t.filter(o=>"active"===o.status);this.allConvertedTemplates=n.map(o=>{const c=o.input_fields&&o.input_fields.length>0?o.input_fields:o.prompt_text?this.promptTemplatesService.getInputFields(o.prompt_text):[];return{template:o.prompt_text||o.name||"No prompt text available",templateName:o.name||"Unnamed Template",usageCount:o.usage_count||0,successRate:85,inputFields:c||[],originalTemplate:o,isDynamic:c&&c.length>0||!!o.prompt_text&&/\{\{[^}]+\}\}/.test(o.prompt_text),familyType:o.family_type,templateCategory:o.template_category||"general"}});const i=[...new Set(n.map(o=>o.family_type))];this.instructionTypes=i.map(o=>({key:this.normalizeKeySegment(o),label:this.formatFamilyLabel(o),count:n.filter(c=>c.family_type===o).length}));const s=new Map;n.forEach(o=>{const c=`${o.family_type}__${o.template_category||"general"}`;s.has(c)||s.set(c,{familyType:o.family_type,templateCategory:o.template_category||"general",count:0}),s.get(c).count++}),this.categories=Array.from(s.entries()).map(([o,c])=>({key:o,label:this.formatCategoryLabel(c.templateCategory),count:c.count,instructionType:this.normalizeKeySegment(c.familyType),familyType:c.familyType,templateCategory:c.templateCategory})),(!this.activeInstructionType||!this.instructionTypes.some(o=>o.key===this.activeInstructionType))&&(this.activeInstructionType=this.instructionTypes[0]?.key||"");const a=this.getCurrentCategories();(!this.activeCategory||!a.some(o=>o.key===this.activeCategory))&&(this.activeCategory=a[0]?.key||""),this.refreshPromptsForCategory(),this.currentPrompts.length>0&&(this.selectedPromptIndex=0,this.initPlaceholdersForSelectedPrompt(),this.buildPreviewParts())}formatFamilyLabel(t){return{hedge_accounting:"Hedge Accounting",risk_management:"Risk Management",compliance:"Compliance",reporting:"Reporting",analysis:"Analysis",operations:"Operations"}[t]||this.formatCategoryLabel(t)}formatCategoryLabel(t){return t.replace(/_/g," ").replace(/\b\w/g,n=>n.toUpperCase())}ensureActiveCategoryForFamily(){const t=this.getCurrentCategories();t&&0!==t.length?this.activeCategory&&t.some(i=>i.key===this.activeCategory)||(this.activeCategory=t[0].key):this.activeCategory=""}normalizeKeySegment(t){return(t||"").toString().trim().toLowerCase().replace(/\s+/g,"_").replace(/[^a-z0-9_]/g,"_")}getFamilyTypeForInstructionType(t){return{instructions:"hedge_accounting",monitoring:"risk_management",risk:"compliance",analysis:"reporting",resolution:"operations",setup:"operations"}[t]||t}getCategoryKeyForFamilyType(t){return null}refreshPromptsForCategory(){const t=this.categories.find(i=>i.key===this.activeCategory);if(!t)return this.currentPrompts=[],void this.cdr.detectChanges();const n=this.allConvertedTemplates.filter(i=>i.familyType===t.familyType&&i.templateCategory===t.templateCategory);this.currentPrompts=[...n],console.log(`\u2713 Updated category "${this.activeCategory}" -> ${this.currentPrompts.length} templates:`,this.currentPrompts.map(i=>i.templateName)),this.cdr.detectChanges(),this.calculateRealUsageStats()}get selectedPromptBase(){return this.currentPrompts[this.selectedPromptIndex]?.template||""}selectPrompt(t){if(this.selectedPromptIndex=t,this.initPlaceholdersForSelectedPrompt(!0),this.buildPreviewParts(),this.isSelectedTemplateDynamic()){const n=this.getSelectedTemplateInputFields();this.dynamicInputValues={},n.forEach(i=>{this.dynamicInputValues[i]=""})}}selectFirstPrompt(){if(this.selectedPromptIndex=0,this.initPlaceholdersForSelectedPrompt(!0),this.buildPreviewParts(),this.isSelectedTemplateDynamic()){const t=this.getSelectedTemplateInputFields();this.dynamicInputValues={},t.forEach(n=>{this.dynamicInputValues[n]=""})}}buildPreviewParts(){const t=this.isSelectedTemplateDynamic()?this.getSelectedTemplateText():this.selectedPromptBase;let n;n=/\{\{[^}]+\}\}/.test(t)?/\{\{([^}]+)\}\}/g:/\[([^\]]+)\]/g;const i=[];let a,s=0;for(;null!==(a=n.exec(t));){a.index>s&&i.push({type:"text",text:t.slice(s,a.index)});const o=a[1].trim().toLowerCase();i.push({type:"placeholder",name:o}),s=n.lastIndex}s<t.length&&i.push({type:"text",text:t.slice(s)}),this.previewParts=i}getOptionsFor(t){switch(t){case"currency":return this.currencies;case"entity scope":case"scope":return this.scopes;case"subsidiary level":return this.subsidiaryLevels;case"risk factor":return this.riskFactors;default:return this.genericOptions}}initPlaceholdersForSelectedPrompt(t=!1){const n=this.isSelectedTemplateDynamic()?this.getSelectedTemplateText():this.selectedPromptBase,i=/\{\{([^}]+)\}\}|\[([^\]]+)\]/g,s={};let a;for(;null!==(a=i.exec(n));){const o=(a[1]||a[2]||"").trim(),c=o.toLowerCase();if(s[c]=!0,this.isSelectedTemplateDynamic())this.dynamicInputValues[o]||(this.dynamicInputValues[o]="");else if("amount"!==c&&!this.placeholderValues[c]){const p=this.getOptionsFor(c);this.placeholderValues[c]=p[0]??""}}t&&(this.isSelectedTemplateDynamic()?Object.keys(this.dynamicInputValues).forEach(o=>{s[o.toLowerCase()]||delete this.dynamicInputValues[o]}):Object.keys(this.placeholderValues).forEach(o=>{"amount"!==o&&!s[o]&&delete this.placeholderValues[o]}))}usePrompt(){let t;t=this.isSelectedTemplateDynamic()?this.getFilledTemplate():this.previewParts.map(n=>"text"===n.type?n.text:"amount"===n.name?(this.amount??0).toFixed(2):"date"===n.name?this.date:this.placeholderValues[n.name]??"").join(""),this.currentMsgUid=this.generateMsgUID(),this.currentInstructionId=this.generateInstructionId(),this.saveCounters(),this.createDatabaseSession(t),this.lastQuery=t,this.showResults=!0,this.isLoading=!0,this.apiResponse="",this.scrollToResults(),this.currentRating=0,this.hasRated=!1,this.updateUsageCount(),this.addToRecentTemplates(),this.sendToDifyAgent(t)}createDatabaseSession(t){var n=this;return(0,y.A)(function*(){try{console.log("Creating database session with:",{promptText:t,msgUid:n.currentMsgUid,instructionId:n.currentInstructionId}),yield n.hawkAgentService.createSession(t,n.currentMsgUid,n.currentInstructionId,n.activeCategory,n.selectedPromptIndex+1),console.log("Database session created successfully")}catch(i){console.error("Error creating database session:",i)}})()}updateDatabaseSession(t,n,i,s){var a=this;return(0,y.A)(function*(){try{console.log("Updating database session:",{msgUid:a.currentMsgUid,status:t,conversationId:n,taskId:i,tokenUsage:s});const o={agent_status:t,agent_response:{text:a.apiResponse,conversation_id:n,task_id:i,...s&&{input_tokens:s.input_tokens||s.prompt_tokens||0,output_tokens:s.output_tokens||s.completion_tokens||0,total_tokens:s.total_tokens||(s.input_tokens||s.prompt_tokens||0)+(s.output_tokens||s.completion_tokens||0),usage:s}}};yield a.hawkAgentService.updateSession(a.currentMsgUid,o),console.log("Database session updated successfully")}catch(o){console.error("Error updating database session:",o)}})()}sendToDifyAgent(t){new x.Lr({Authorization:"Bearer app-KKtaMynVyn8tKbdV9VbbaeyR","Content-Type":"application/json"});const s={conversation_id:"",inputs:{msg_uid:this.currentMsgUid,instruction_id:this.currentInstructionId},query:`[MSG_UID: ${this.currentMsgUid}] [INSTRUCTION_ID: ${this.currentInstructionId}] ${t}`,user:"test-user",response_mode:"streaming"};this.streamBuffer="",this.apiResponse="",this.isStreaming=!0,fetch("https://api.dify.ai/v1/chat-messages",{method:"POST",headers:{Authorization:"Bearer app-KKtaMynVyn8tKbdV9VbbaeyR","Content-Type":"application/json"},body:JSON.stringify(s)}).then(a=>{if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);if(!a.body)throw new Error("Response body is null");this.isLoading=!1;const o=a.body.getReader();return this.reader=o,this.processStream(o)}).catch(a=>{console.error("Error sending to Dify:",a),this.isLoading=!1,this.isStreaming=!1,this.apiResponse=`Error: ${a.message}\n\nPlease check your network connection and API configuration.`})}processStream(t){var n=this;return(0,y.A)(function*(){const i=new TextDecoder;let s="",a="",o="",c=null;try{for(;;){const{done:p,value:g}=yield t.read();if(p){console.log("Stream completed"),n.isStreaming=!1,n.finishStream(s,a,c);break}o+=i.decode(g,{stream:!0});const d=o.split("\n");o=d.pop()||"";for(const _ of d)if(_.startsWith("data: "))try{const m=JSON.parse(_.substring(6));if(!s&&m.conversation_id&&(s=m.conversation_id),!a&&m.task_id&&(a=m.task_id),"agent_message"===m.event&&m.answer&&(n.streamBuffer+=m.answer,n.apiResponse=n.streamBuffer),(m.metadata?.usage||m.usage)&&(c=m.metadata?.usage||m.usage,console.log("Token usage captured:",c)),"message_end"===m.event||"workflow_finished"===m.event)return console.log("Stream end event received:",m.event),console.log("Final token usage:",c),n.isStreaming=!1,void n.finishStream(s,a,c)}catch(m){console.warn("Failed to parse streaming data line:",_,m)}}}catch(p){console.error("Stream processing error:",p),n.isStreaming=!1,n.apiResponse+="\n\n[Stream interrupted due to error]",n.updateDatabaseSession("failed",s,a,c)}finally{t.releaseLock()}})()}finishStream(t,n,i){let s="\n\n---\n";s+=`Message UID: ${this.currentMsgUid}\n`,s+=`Instruction ID: ${this.currentInstructionId}\n`,t&&(s+=`Conversation ID: ${t}\n`),n&&(s+=`Task ID: ${n}`),i&&(s+=`\nInput Tokens: ${i.input_tokens||i.prompt_tokens||0}`,s+=`\nOutput Tokens: ${i.output_tokens||i.completion_tokens||0}`,s+=`\nTotal Tokens: ${i.total_tokens||(i.input_tokens||i.prompt_tokens||0)+(i.output_tokens||i.completion_tokens||0)}`),this.apiResponse+=s,this.updateDatabaseSession("completed",t,n,i),this.addToHistory(this.lastQuery,this.apiResponse)}clearResults(){if(this.showResults=!1,this.apiResponse="",this.lastQuery="",this.currentMsgUid="",this.currentInstructionId="",this.isLoading=!1,this.isStreaming=!1,this.streamBuffer="",this.currentRating=0,this.hasRated=!1,this.reader&&!this.reader.closed){try{this.reader.cancel()}catch(t){console.warn("Reader cleanup error in clearResults:",t)}this.reader=void 0}}getCleanResponse(){return this.apiResponse?this.apiResponse.split("\n\n---\n")[0]||this.apiResponse:""}getFormattedResponse(){if(!this.apiResponse)return this.sanitizer.bypassSecurityTrustHtml("");let n=this.getCleanResponse().replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>");n=this.convertTablesToHtml(n);const i=n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/&lt;strong&gt;(.*?)&lt;\/strong&gt;/g,"<strong>$1</strong>").replace(/&lt;table([^&]*)&gt;/g,"<table$1>").replace(/&lt;\/table&gt;/g,"</table>").replace(/&lt;thead([^&]*)&gt;/g,"<thead$1>").replace(/&lt;\/thead&gt;/g,"</thead>").replace(/&lt;tbody([^&]*)&gt;/g,"<tbody$1>").replace(/&lt;\/tbody&gt;/g,"</tbody>").replace(/&lt;tr([^&]*)&gt;/g,"<tr$1>").replace(/&lt;\/tr&gt;/g,"</tr>").replace(/&lt;th([^&]*)&gt;/g,"<th$1>").replace(/&lt;\/th&gt;/g,"</th>").replace(/&lt;td([^&]*)&gt;/g,"<td$1>").replace(/&lt;\/td&gt;/g,"</td>").replace(/\n/g,"<br>");return this.sanitizer.bypassSecurityTrustHtml(i)}convertTablesToHtml(t){const n=t.split("\n");let i="",s=!1,a=[];for(let o=0;o<n.length;o++){const c=n[o].trim();if(c.startsWith("|")&&c.endsWith("|")&&c.includes("|")){s||(s=!0,a=[]);const p=c.split("|").slice(1,-1).map(d=>d.trim());a.push(p);const h=(o+1<n.length?n[o+1].trim():"").match(/^\|[\s\-:]+\|$/);if(o===n.length-1||!n[o+1].trim().startsWith("|")||h){h&&o++;let d='<table class="min-w-full divide-y divide-gray-200 border border-gray-300 rounded-lg overflow-hidden my-4">';if(a.length>0&&(d+='<thead class="bg-gray-50">',d+="<tr>",a[0].forEach(_=>{d+=`<th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border-b border-gray-200">${_}</th>`}),d+="</tr>",d+="</thead>"),a.length>1){d+='<tbody class="bg-white divide-y divide-gray-200">';for(let _=1;_<a.length;_++)d+='<tr class="hover:bg-gray-50">',a[_].forEach(m=>{d+=`<td class="px-4 py-3 text-sm text-gray-900 border-b border-gray-100">${m}</td>`}),d+="</tr>";d+="</tbody>"}d+="</table>",i+=d,s=!1,a=[]}}else{if(s){if(a.length>0){let p='<table class="min-w-full divide-y divide-gray-200 border border-gray-300 rounded-lg overflow-hidden my-4">';p+='<tbody class="bg-white divide-y divide-gray-200">',a.forEach(g=>{p+='<tr class="hover:bg-gray-50">',g.forEach(h=>{p+=`<td class="px-4 py-3 text-sm text-gray-900 border-b border-gray-100">${h}</td>`}),p+="</tr>"}),p+="</tbody>",p+="</table>",i+=p}s=!1,a=[]}i+=c+"\n"}}return i}getResponseMetadata(){if(!this.apiResponse)return"";const t=this.apiResponse.split("\n\n---\n");return t.length>1?t[1].trim():""}getCategoryLabel(t){const n=this.categories.find(i=>i.key===t);return n?n.label:t}isFormValid(){if(this.isSelectedTemplateDynamic())return this.getSelectedTemplateInputFields().every(o=>{const c=this.dynamicInputValues[o];return null!=c&&("string"==typeof c&&""!==c.trim()||"number"==typeof c&&!isNaN(c))});const t=this.previewParts.filter(a=>"placeholder"===a.type),n=!t.some(a=>"amount"===a.name)||null!==this.amount&&this.amount>0,i=!t.some(a=>"date"===a.name)||!!this.date,s=t.filter(a=>"amount"!==a.name&&"date"!==a.name).every(a=>this.placeholderValues[a.name]);return n&&i&&s}getPlaceholderParts(){return this.previewParts.filter(t=>"placeholder"===t.type)}getCurrentDateTime(){return(new Date).toLocaleString()}formatDate(t){return t.toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}getResultStatus(){if(!this.apiResponse)return"Processing";const t=this.getCleanResponse().toLowerCase();return t.includes("approved")||t.includes("confirmed")?"Approved":t.includes("rejected")||t.includes("denied")?"Rejected":t.includes("pending")||t.includes("review")?"Pending Review":"Completed"}getStatusBadgeClass(){switch(this.getResultStatus()){case"Approved":return"bg-green-100 text-green-800 border border-green-200";case"Rejected":return"bg-red-100 text-red-800 border border-red-200";case"Pending Review":return"bg-yellow-100 text-yellow-800 border border-yellow-200";default:return"bg-blue-100 text-blue-800 border border-blue-200"}}getStatusIcon(){switch(this.getResultStatus()){case"Approved":return"pi pi-check-circle";case"Rejected":return"pi pi-times-circle";case"Pending Review":return"pi pi-clock";default:return"pi pi-info-circle"}}addToRecentTemplates(){const t={label:`Template ${this.selectedPromptIndex+1}`,category:this.activeCategory,index:this.selectedPromptIndex};this.recentTemplates=this.recentTemplates.filter(n=>!(n.category===t.category&&n.index===t.index)),this.recentTemplates.unshift(t),this.recentTemplates=this.recentTemplates.slice(0,5)}loadRecentTemplate(t){this.activeCategory=t.category,this.refreshPromptsForCategory(),this.selectedPromptIndex=t.index,this.selectPrompt(t.index)}addToHistory(t,n){const i={query:t,response:n,timestamp:new Date,status:this.getResultStatus(),msgUid:this.currentMsgUid,instructionId:this.currentInstructionId};this.queryHistory.unshift(i),this.queryHistory=this.queryHistory.slice(0,20)}toggleHistory(){this.showHistory=!this.showHistory}loadHistoryItem(t){this.lastQuery=t.query,this.apiResponse=t.response,this.currentMsgUid=t.msgUid||"",this.currentInstructionId=t.instructionId||"",this.showResults=!0,this.showHistory=!1}getHistoryStatusClass(t){switch(t){case"Approved":return"bg-green-100 text-green-800";case"Rejected":return"bg-red-100 text-red-800";case"Pending Review":return"bg-yellow-100 text-yellow-800";default:return"bg-blue-100 text-blue-800"}}saveAsTemplate(){console.log("Save template clicked")}exportReport(){console.log("Export report clicked")}createTicket(){console.log("Create ticket clicked")}scheduleReview(){console.log("Schedule review clicked")}shareResults(){console.log("Share results clicked")}setCompletionStatus(t){var n=this;return(0,y.A)(function*(){n.completionStatus=t;try{if(n.currentMsgUid&&n.currentInstructionId){const s=(yield n.hawkAgentService.getSessions()).find(a=>a.msg_uid===n.currentMsgUid);if(s){const a="complete"===t?"completed":"failed",o={...s.metadata,completion_status:t,completion_date:(new Date).toISOString(),user_marked:!0};yield n.hawkAgentService.updateSession(n.currentMsgUid,{agent_status:a,metadata:o}),console.log(`Task marked as ${t}, agent_status updated to ${a}`),n.updateTemplateMetricsFromCompletion(t)}}yield n.calculateRealUsageStats()}catch(i){console.error("Error saving completion status:",i)}})()}updateTemplateMetricsFromCompletion(t){if(this.selectedPromptIndex>=0&&this.currentPrompts[this.selectedPromptIndex]){const n=this.currentPrompts[this.selectedPromptIndex],i="complete"===t,a=Math.round(n.successRate*n.usageCount/100)+(i?1:0),o=n.usageCount+1;n.successRate=Math.round(a/o*100),n.usageCount=o,this.updateMasterTemplateData("both")}}setRating(t){this.currentRating=t,this.hasRated||(this.hasRated=!0,this.updateSuccessRate(t))}updateUsageCount(){this.selectedPromptIndex>=0&&this.currentPrompts[this.selectedPromptIndex]&&(this.currentPrompts[this.selectedPromptIndex].usageCount++,this.updateMasterTemplateData("usage"))}updateSuccessRate(t){if(this.selectedPromptIndex>=0&&this.currentPrompts[this.selectedPromptIndex]){const n=this.currentPrompts[this.selectedPromptIndex],o=Math.round((n.usageCount*n.successRate/100+(t>=4?1:0))/n.usageCount*100);n.successRate=o,this.updateMasterTemplateData("success")}}updateMasterTemplateData(t){if(this.selectedPromptIndex>=0){const n=this.currentPrompts[this.selectedPromptIndex];n&&(this.promptsMap[this.activeCategory][this.selectedPromptIndex]={...n})}}getCurrentTemplateSuccessRate(){return this.selectedPromptIndex>=0&&this.currentPrompts[this.selectedPromptIndex]?this.currentPrompts[this.selectedPromptIndex].successRate:0}getCurrentTemplateUsageCount(){return this.selectedPromptIndex>=0&&this.currentPrompts[this.selectedPromptIndex]?this.currentPrompts[this.selectedPromptIndex].usageCount:0}scrollToResults(){setTimeout(()=>{const t=this.resultsSectionRef?.nativeElement;t&&(t.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"}),setTimeout(()=>{try{const n=t.getBoundingClientRect(),i=window.scrollY+n.top-100;window.scrollTo({top:i,behavior:"smooth"})}catch{t.scrollIntoView()}},50))},300)}onInstructionTypeSelect(t){this.activeInstructionType!==t&&(this.activeInstructionType=t,this.ensureActiveCategoryForFamily(),this.refreshPromptsForCategory(),this.currentPrompts.length>0?this.selectFirstPrompt():this.selectedPromptIndex=-1)}onCategorySelect(t){this.activeCategory!==t&&(console.log(`\u{1f504} Category changed: "${this.activeCategory}" -> "${t}"`),this.activeCategory=t,this.selectedPromptIndex=-1,this.refreshPromptsForCategory(),this.currentPrompts.length>0&&this.selectFirstPrompt(),this.cdr.detectChanges())}getCurrentCategories(){return this.categories.filter(t=>t.instructionType===this.activeInstructionType)}getCategoryTabClass(t){return this.activeCategory===t?"bg-blue-600 text-white shadow-lg transform scale-105":"bg-white text-gray-700 hover:bg-blue-50 hover:text-blue-700 shadow-sm"}getSelectedCategoryLabel(){const t=this.categories.find(n=>n.key===this.activeCategory);return t?t.label:"Select a Category"}getSelectedInstructionTypeLabel(){const t=this.instructionTypes.find(n=>n.key===this.activeInstructionType);return t?t.label:""}getSuccessRateClass(t){return t>=95?"text-green-600":t>=90?"text-blue-600":t>=85?"text-yellow-600":"text-red-600"}formatUsageCount(t){return t>=1e3?Math.floor(t/1e3)+"K":t.toString()}getTemplatePreview(t){if(t.length<=120)return t;const i=t.substring(0,120),s=i.lastIndexOf(" ");return s>96?i.substring(0,s)+"...":i+"..."}calculateRealUsageStats(){var t=this;return(0,y.A)(function*(){try{const n=yield t.hawkAgentService.getSessions();console.log("All sessions from database:",n),t.currentPrompts.forEach((i,s)=>{const a=n.filter(g=>g.template_category===t.activeCategory&&g.template_index===s+1),o=a.length,c=a.filter(g=>{const h="completed"===g.agent_status;return!("complete"!==g.metadata?.completion_status)||!("incomplete"===g.metadata?.completion_status)&&h}),p=o>0?Math.round(c.length/o*100):0;i.usageCount=o,i.successRate=p}),t.promptsMap[t.activeCategory]=[...t.currentPrompts]}catch(n){console.error("Error calculating usage stats:",n)}})()}onPlaceholderChange(t,n){this.placeholderValues[t]=n}onAgentModeToggle(t){this.isAgentMode=t}onIframeLoad(){}onIframeError(){}dismissPromptToast(){this.showPromptToast=!1}minimizePromptToast(){this.isMinimized=!0}expandPromptToast(){this.isMinimized=!1}copyPrompt(){var t=this;return(0,y.A)(function*(){if(t.incomingPrompt)try{yield navigator.clipboard?.writeText(t.incomingPrompt),t.copied=!0,setTimeout(()=>t.copied=!1,1500)}catch{}})()}sendPromptToIframe(){if(!this.incomingPrompt)return;const t=this.agentFrameRef?.nativeElement?.contentWindow;if(!t)return;const n=[{type:"preset_input",text:this.incomingPrompt},{type:"set_input",text:this.incomingPrompt},{type:"prefill",text:this.incomingPrompt},{type:"init_message",text:this.incomingPrompt},{event:"set_input",value:this.incomingPrompt}];try{const i="*"===this.agentOrigin?"*":this.agentOrigin;for(const s of n)t.postMessage(s,i)}catch{}}isSelectedTemplateDynamic(){if(this.selectedPromptIndex<0||!this.currentPrompts[this.selectedPromptIndex])return!1;if(this.currentPrompts[this.selectedPromptIndex].isDynamic)return!0;const n=this.getSelectedTemplateText();return/\{\{[^}]+\}\}/.test(n)||/\[[^\]]+\]/.test(n)}getSelectedTemplateName(){if(this.selectedPromptIndex<0||!this.currentPrompts[this.selectedPromptIndex])return"";const t=this.currentPrompts[this.selectedPromptIndex];return t.templateName||t.originalTemplate?.name||""}getSelectedTemplateText(){if(this.selectedPromptIndex<0||!this.currentPrompts[this.selectedPromptIndex])return"";const t=this.currentPrompts[this.selectedPromptIndex];return t.originalTemplate?.prompt_text||t.template}getSelectedTemplateInputFields(){if(this.selectedPromptIndex<0||!this.currentPrompts[this.selectedPromptIndex])return[];const t=this.getSelectedTemplateText();return this.extractFieldsFromText(t)}formatFieldLabel(t){return t.replace(/_/g," ").replace(/\b\w/g,n=>n.toUpperCase())}onDynamicInputChange(){console.log("Dynamic input changed:",this.dynamicInputValues),this.cdr.detectChanges()}getFilledTemplate(){if(this.selectedPromptIndex<0||!this.currentPrompts[this.selectedPromptIndex])return console.log("getFilledTemplate: no selected prompt"),"";const t=this.currentPrompts[this.selectedPromptIndex],n=t.originalTemplate?.prompt_text||t.template;if(console.log("getFilledTemplate called with:",{templateText:n,dynamicInputValues:this.dynamicInputValues}),t.originalTemplate&&this.promptTemplatesService.fillTemplate){const s=this.promptTemplatesService.fillTemplate(n,this.dynamicInputValues);return console.log("Service filled template:",s),s}let i=n;return Object.keys(this.dynamicInputValues).forEach(s=>{const a=new RegExp(`\\{\\{${s}\\}\\}`,"g"),o=this.dynamicInputValues[s]||`{{${s}}}`;i=i.replace(a,o),console.log(`Replaced {{${s}}} with "${o}"`)}),console.log("Final filled template:",i),i}extractFieldsFromText(t){const n=new Set,i=/\{\{([^}]+)\}\}/g;let s;for(;null!==(s=i.exec(t));){const o=(s[1]||"").trim();o&&n.add(o)}const a=/\[([^\]]+)\]/g;for(;null!==(s=a.exec(t));){const o=(s[1]||"").trim();o&&n.add(o)}return Array.from(n)}static{this.\u0275fac=function(n){return new(n||r)(e.rXU(I.up),e.rXU(x.Qq),e.rXU(P.P),e.rXU(k.G),e.rXU(R.r),e.rXU(e.gRc))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-hawk-prompt-templates"]],viewQuery:function(n,i){if(1&n&&(e.GBs(F,5),e.GBs(w,5)),2&n){let s;e.mGM(s=e.lsd())&&(i.agentFrameRef=s.first),e.mGM(s=e.lsd())&&(i.resultsSectionRef=s.first)}},standalone:!0,features:[e.aNF],decls:19,vars:10,consts:[["agentFrame",""],["resultsSection",""],[1,"p-6","space-y-4","min-h-full","flex","flex-col"],[1,"flex","items-center","justify-between"],[1,"text-xl","font-semibold","text-gray-900"],[1,"text-xs","text-gray-500"],[1,"flex","items-center","gap-3"],[1,"text-sm",3,"ngClass"],[1,"inline-flex","items-center","cursor-pointer"],["type","checkbox",1,"sr-only",3,"ngModelChange","ngModel"],["role","switch",1,"relative"],[1,"w-12","h-7","rounded-full","transition-colors","duration-200","shadow-inner","ring-1",3,"ngClass"],[1,"absolute","top-0.5","left-0.5","w-6","h-6","bg-white","rounded-full","shadow","transform","transition","duration-200"],["class","space-y-6 flex-1 flex flex-col min-h-0",4,"ngIf"],["class","flex flex-col space-y-6",4,"ngIf"],[1,"space-y-6","flex-1","flex","flex-col","min-h-0"],[1,"bg-white","rounded-lg","border","border-gray-200","overflow-hidden","relative","flex-1","min-h-0"],["class","absolute z-30 top-4 right-4 max-w-xl pointer-events-none",4,"ngIf"],["class","absolute z-30 top-4 right-4 pointer-events-none",4,"ngIf"],[1,"w-full","h-full","flex-1","min-h-0"],["allow","microphone; clipboard-write;","frameborder","0",1,"transition-opacity","duration-300",2,"width","100%","height","100%","min-height","700px","display","block",3,"src"],[1,"absolute","z-30","top-4","right-4","max-w-xl","pointer-events-none"],[1,"flex","items-center","gap-3","bg-gray-900/90","text-white","rounded-md","px-3","py-2","shadow-lg","border","border-gray-800","pointer-events-auto"],[1,"text-sm","truncate","flex-1"],[1,"font-medium"],[1,"ml-1"],["title","Copy to clipboard",1,"btn","btn-secondary",3,"click"],[1,"pi","pi-copy"],[1,"btn","btn-primary",3,"click"],[1,"pi","pi-send"],["title","Minimize",1,"btn","btn-tertiary",3,"click"],[1,"pi","pi-minus"],["title","Dismiss",1,"btn","btn-tertiary",3,"click"],[1,"pi","pi-times"],[1,"absolute","z-30","top-4","right-4","pointer-events-none"],[1,"flex","items-center","gap-2","bg-gray-900/90","text-white","rounded-full","px-3","py-1.5","shadow-md","border","border-gray-800","pointer-events-auto"],[1,"pi","pi-comment"],[1,"text-xs","truncate","max-w-[260px]"],["title","Copy",1,"btn","btn-secondary",3,"click"],[1,"pi","pi-copy","text-xs"],["title","Expand",1,"btn","btn-primary",3,"click"],[1,"pi","pi-angle-up"],[1,"flex","flex-col","space-y-6"],[1,"bg-white","border-b","border-gray-200","px-6","py-3"],[1,"flex","flex-wrap","gap-2"],["class","px-4 py-2 rounded-lg text-sm font-medium transition-colors",3,"ngClass","click",4,"ngFor","ngForOf","ngForTrackBy"],[1,"flex","bg-white","rounded-xl","shadow-sm","border","border-gray-200","overflow-hidden",2,"min-height","600px"],[1,"w-72","bg-gray-50","border-r","border-gray-200","flex","flex-col"],[1,"px-6","py-4","border-b","border-gray-200","bg-white"],[1,"text-lg","font-semibold","text-gray-900"],[1,"text-sm","text-gray-600","mt-1"],["class","p-4 border-b border-gray-200",4,"ngIf"],[1,"flex-1","overflow-y-auto"],[1,"p-4","space-y-3"],["class","w-full text-left px-5 py-4 rounded-lg text-sm font-medium transition-all duration-200 group",3,"class","click",4,"ngFor","ngForOf","ngForTrackBy"],["class","text-center py-12 text-gray-500",4,"ngIf"],[1,"flex-1","flex","flex-col","min-w-0"],[1,"bg-white","border-b","border-gray-200","px-6","py-4"],[1,"text-sm","text-gray-500"],[1,"bg-white","flex-1","overflow-hidden","flex","flex-col"],[1,"px-6","py-4","border-b","border-gray-100"],[1,"divide-y","divide-gray-50"],["class","flex items-center gap-4 px-6 py-4 cursor-pointer hover:bg-gray-50 transition-colors",4,"ngFor","ngForOf","ngForTrackBy"],["class","px-6 py-10 text-sm text-gray-500",4,"ngIf"],["class","border-t border-gray-200 bg-gray-50",4,"ngIf"],["class","bg-white rounded-xl shadow-sm border border-gray-200 mt-6",4,"ngIf"],["class","bg-white rounded-xl shadow-sm border border-gray-200 mt-6 w-full overflow-hidden",4,"ngIf"],[1,"px-4","py-2","rounded-lg","text-sm","font-medium","transition-colors",3,"click","ngClass"],[1,"text-xs","opacity-75"],[1,"p-4","border-b","border-gray-200"],[1,"text-xs","font-medium","text-gray-500","uppercase","tracking-wide","mb-2"],[1,"space-y-1"],["class","w-full text-left px-3 py-2 text-xs bg-white hover:bg-blue-50 hover:text-blue-700 rounded-md text-gray-700 transition-colors border border-gray-200",3,"click",4,"ngFor","ngForOf"],[1,"w-full","text-left","px-3","py-2","text-xs","bg-white","hover:bg-blue-50","hover:text-blue-700","rounded-md","text-gray-700","transition-colors","border","border-gray-200",3,"click"],[1,"w-full","text-left","px-5","py-4","rounded-lg","text-sm","font-medium","transition-all","duration-200","group",3,"click"],[1,"flex-1"],[1,"px-3","py-1","rounded-full","text-xs","font-medium"],[1,"text-center","py-12","text-gray-500"],[1,"text-4xl","mb-2"],[1,"text-sm","font-medium"],[1,"text-xs","text-gray-400","mt-1"],[1,"flex","items-center","gap-4","px-6","py-4","cursor-pointer","hover:bg-gray-50","transition-colors"],[1,"flex","items-center","justify-center"],["type","radio","name","prompt",1,"text-blue-600",3,"change","checked"],[1,"flex","items-center","gap-4","flex-1","min-w-0"],[1,"w-20","flex-shrink-0","text-center"],[1,"text-sm","font-medium","text-gray-900"],[1,"flex-1","min-w-0"],[1,"text-sm","text-gray-700","leading-relaxed"],["class","text-xs text-blue-600 mt-1",4,"ngIf"],[1,"w-24","flex-shrink-0","flex","items-center","justify-center","gap-2"],[1,"flex","items-center","justify-center","w-8","h-8","rounded-full","text-xs","font-medium","text-gray-700","bg-blue-100",3,"title"],[1,"flex","items-center","justify-center","w-8","h-8","rounded-full","text-xs","font-medium","text-gray-700","bg-green-100",3,"title"],[1,"text-xs","text-blue-600","mt-1"],[1,"pi","pi-cog","mr-1"],[1,"px-6","py-10","text-sm","text-gray-500"],[1,"border-t","border-gray-200","bg-gray-50"],[1,"px-6","py-4"],[1,"text-md","font-semibold","text-gray-900","mb-4"],[1,"bg-white","rounded-lg","p-4","border","border-gray-300","mb-4"],["class","text-sm text-gray-900 font-mono leading-relaxed flex flex-wrap items-center gap-2",4,"ngIf"],["class","space-y-4",4,"ngIf"],[1,"btn","btn-secondary",3,"click"],[1,"pi","pi-bookmark"],[1,"btn","btn-primary","btn-lg",3,"click","disabled"],["class","flex items-center gap-2",4,"ngIf"],[1,"text-sm","text-gray-900","font-mono","leading-relaxed","flex","flex-wrap","items-center","gap-2"],[4,"ngFor","ngForOf","ngForTrackBy"],["class","text-gray-800",4,"ngIf"],[4,"ngIf"],[1,"text-gray-800"],["type","number","class","inline-input bg-blue-50 border border-blue-300 rounded px-2 py-1 text-sm w-24 font-semibold","placeholder","0.00",3,"ngModel","ngModelChange",4,"ngIf"],["type","date","class","inline-input bg-blue-50 border border-blue-300 rounded px-2 py-1 text-sm w-36 font-semibold",3,"ngModel","ngModelChange",4,"ngIf"],["class","inline-input bg-blue-50 border border-blue-300 rounded px-2 py-1 text-sm w-auto min-w-32 font-semibold",3,"ngModel","ngModelChange",4,"ngIf"],["type","number","placeholder","0.00",1,"inline-input","bg-blue-50","border","border-blue-300","rounded","px-2","py-1","text-sm","w-24","font-semibold",3,"ngModelChange","ngModel"],["type","date",1,"inline-input","bg-blue-50","border","border-blue-300","rounded","px-2","py-1","text-sm","w-36","font-semibold",3,"ngModelChange","ngModel"],[1,"inline-input","bg-blue-50","border","border-blue-300","rounded","px-2","py-1","text-sm","w-auto","min-w-32","font-semibold",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf","ngForTrackBy"],[3,"value"],[1,"space-y-4"],["class","mt-4 p-3 bg-green-50 border border-green-200 rounded",4,"ngIf"],["type","text","class","inline-input bg-blue-50 border border-blue-300 rounded px-2 py-1 text-sm w-auto min-w-32 font-semibold",3,"placeholder","ngModel","ngModelChange",4,"ngIf"],["type","text",1,"inline-input","bg-blue-50","border","border-blue-300","rounded","px-2","py-1","text-sm","w-auto","min-w-32","font-semibold",3,"ngModelChange","placeholder","ngModel"],[1,"mt-4","p-3","bg-green-50","border","border-green-200","rounded"],[1,"text-xs","font-medium","text-green-700","mb-2"],[1,"text-sm","text-green-800","leading-relaxed","whitespace-pre-wrap"],[1,"flex","items-center","gap-2"],[1,"animate-spin","rounded-full","h-4","w-4","border-b-2","border-white"],[1,"bg-white","rounded-xl","shadow-sm","border","border-gray-200","mt-6"],[1,"px-6","py-4","border-b","border-gray-200","flex","items-center","justify-between"],[1,"btn","btn-tertiary",3,"click"],[1,"divide-y","divide-gray-100"],["class","px-6 py-4 hover:bg-gray-50 cursor-pointer",3,"click",4,"ngFor","ngForOf"],[1,"px-6","py-4","hover:bg-gray-50","cursor-pointer",3,"click"],[1,"flex","items-start","justify-between"],[1,"text-xs","text-gray-500","mt-1"],["class","flex items-center gap-4 mt-2",4,"ngIf"],[1,"px-2","py-1","text-xs","rounded-full",3,"ngClass"],[1,"flex","items-center","gap-4","mt-2"],[1,"flex","items-center","gap-1"],[1,"pi","pi-id-card","text-xs","text-gray-400"],[1,"text-xs","font-mono","text-gray-600"],[1,"pi","pi-bookmark","text-xs","text-gray-400"],[1,"bg-white","rounded-xl","shadow-sm","border","border-gray-200","mt-6","w-full","overflow-hidden"],[1,"px-6","py-4","flex","items-center","justify-between"],[1,"p-6","max-w-full","overflow-hidden"],["class","text-center py-12",4,"ngIf"],["class","space-y-6",4,"ngIf"],[1,"text-center","py-12"],[1,"animate-spin","rounded-full","h-12","w-12","border-b-2","border-blue-600","mx-auto"],[1,"mt-4","text-gray-600"],[1,"w-64","bg-gray-200","rounded-full","h-2","mx-auto","mt-2"],[1,"bg-blue-600","h-2","rounded-full","animate-pulse",2,"width","60%"],[1,"space-y-6"],[1,"flex","items-center","gap-2","px-3","py-1","rounded-full","text-sm","font-medium",3,"ngClass"],[1,"bg-gray-50","rounded-lg","p-4","border","border-gray-200","mb-4"],[1,"text-sm","font-medium","text-gray-700","mb-3"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-3"],[1,"pi","pi-id-card","text-gray-500"],[1,"font-mono","text-sm","font-semibold","text-gray-800"],[1,"pi","pi-bookmark","text-gray-500"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4"],[1,"bg-blue-50","rounded-lg","p-4","border","border-blue-200"],[1,"text-sm","font-medium","text-blue-900"],[1,"text-lg","font-semibold","text-blue-700"],[1,"bg-green-50","rounded-lg","p-4","border","border-green-200"],[1,"text-sm","font-medium","text-green-900"],[1,"text-lg","font-semibold","text-green-700"],[1,"bg-purple-50","rounded-lg","p-4","border","border-purple-200"],[1,"text-sm","font-medium","text-purple-900"],[1,"text-lg","font-semibold","text-purple-700"],[1,"bg-gradient-to-br","from-blue-50","to-indigo-50","rounded-xl","border","border-blue-200","overflow-hidden","w-full"],[1,"w-full","max-w-none","overflow-auto","max-h-96"],[1,"text-gray-800","leading-relaxed","text-sm","font-sans","w-full","prose","prose-sm","max-w-none",2,"word-break","break-word","overflow-wrap","anywhere","max-width","100%","font-family","inherit",3,"innerHTML"],["class","flex items-center gap-2 mt-3 p-3 bg-blue-50 rounded-lg border border-blue-200",4,"ngIf"],["class","px-6 py-3 bg-blue-100 border-t border-blue-200",4,"ngIf"],[1,"flex","flex-wrap","gap-3","mb-6"],[1,"pi","pi-download"],[1,"pi","pi-ticket"],[1,"pi","pi-calendar"],[1,"pi","pi-share-alt"],[1,"border-t","border-gray-200","pt-6"],[1,"text-sm","font-medium","text-gray-900","mb-2"],[1,"text-xs","text-gray-600","mb-3"],["class","text-lg transition-colors duration-200",3,"class","click",4,"ngFor","ngForOf","ngForTrackBy"],[1,"flex","items-center","gap-2","ml-4"],[1,"px-3","py-1","text-xs","rounded-full","border","transition-colors",3,"click"],[1,"pi","pi-check-circle","mr-1"],[1,"pi","pi-times-circle","mr-1"],[1,"flex","items-center","gap-2","ml-4","border-l","border-gray-300","pl-4"],[1,"pi","pi-check","mr-1"],[1,"pi","pi-exclamation-triangle","mr-1"],["class","mt-3 p-3 bg-blue-50 border border-blue-200 rounded-lg",4,"ngIf"],[1,"text-right","ml-6"],[1,"text-lg","font-semibold"],[1,"flex","items-center","gap-2","mt-3","p-3","bg-blue-50","rounded-lg","border","border-blue-200"],[1,"animate-spin","rounded-full","h-4","w-4","border-b-2","border-blue-600"],[1,"text-sm","text-blue-700","font-medium"],[1,"flex","gap-1","ml-2"],[1,"w-1","h-1","bg-blue-500","rounded-full","animate-pulse"],[1,"w-1","h-1","bg-blue-500","rounded-full","animate-pulse",2,"animation-delay","0.2s"],[1,"w-1","h-1","bg-blue-500","rounded-full","animate-pulse",2,"animation-delay","0.4s"],[1,"px-6","py-3","bg-blue-100","border-t","border-blue-200"],[1,"text-xs","text-blue-700","font-mono"],[1,"text-lg","transition-colors","duration-200",3,"click"],[1,"pi","pi-star-fill"],[1,"mt-3","p-3","bg-blue-50","border","border-blue-200","rounded-lg"],[1,"flex","items-center","gap-2","text-sm"],[1,"pi","pi-info-circle","text-blue-600"],[1,"text-blue-800"]],template:function(n,i){1&n&&(e.j41(0,"div",2)(1,"div",3)(2,"div")(3,"h2",4),e.EFF(4),e.k0s(),e.j41(5,"div",5),e.EFF(6,"HAWK Agent"),e.k0s()(),e.j41(7,"div",6)(8,"span",7),e.EFF(9,"Template Mode"),e.k0s(),e.j41(10,"label",8)(11,"input",9),e.mxI("ngModelChange",function(a){return e.DH7(i.isAgentMode,a)||(i.isAgentMode=a),a}),e.bIt("ngModelChange",function(a){return i.onAgentModeToggle(a)}),e.k0s(),e.j41(12,"div",10),e.nrm(13,"div",11)(14,"div",12),e.k0s()(),e.j41(15,"span",7),e.EFF(16,"Agent Mode"),e.k0s()()(),e.DNE(17,$,7,3,"div",13)(18,ve,37,16,"div",14),e.k0s()),2&n&&(e.R7$(4),e.JRh(i.isAgentMode?"Agent Mode":"Template Mode"),e.R7$(4),e.Y8G("ngClass",i.isAgentMode?"text-gray-400":"text-blue-700 font-medium"),e.R7$(3),e.R50("ngModel",i.isAgentMode),e.R7$(),e.BMQ("aria-checked",i.isAgentMode),e.R7$(),e.Y8G("ngClass",i.isAgentMode?"bg-blue-600 ring-blue-600":"bg-gray-300 ring-gray-300"),e.R7$(),e.AVh("translate-x-5",i.isAgentMode),e.R7$(),e.Y8G("ngClass",i.isAgentMode?"text-blue-700 font-medium":"text-gray-400"),e.R7$(2),e.Y8G("ngIf",i.isAgentMode),e.R7$(),e.Y8G("ngIf",!i.isAgentMode))},dependencies:[b.MD,b.YU,b.Sq,b.bT,f.YN,f.xH,f.y7,f.me,f.Q0,f.Zm,f.wz,f.BC,f.vS,C.P],styles:[".line-clamp-2[_ngcontent-%COMP%]{display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;text-overflow:ellipsis}"]})}}return r})()}}]);